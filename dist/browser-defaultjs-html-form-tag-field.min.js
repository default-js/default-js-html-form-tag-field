(()=>{var t={97:(t,e,n)=>{"use strict";n.r(e),n.d(e,{FormTagFieldElement:()=>pt});const r=`${n(330).NODENAME_FORM}-tag-field`,i=`${r}-input-validation`;var a=n(303),s=n(892);n(609);const o={},l=async(t,e,n)=>c(create(t,!0),e,n),c=async(t,e,n)=>{let r=null;if(t instanceof HTMLTemplateElement)r=new u(t,n);else{if(r=document.createElement("template"),!(t instanceof Node||t instanceof NodeList||t instanceof HTMLCollection||t instanceof Array))throw new Error("Template type is not supported!");r.content.append(t.cloneNode(!0)),r=new u(r,n)}if(!r)throw new Error("Template can't loaded!");return e&&n&&(o[n]=r),r};class u{constructor(t,e){this.template=t,this.key=e}importContent(t=document){return t.importNode(this.template,!0).content.childNodes}remove(){this.key&&o[this.key]&&delete o[this.key]}static async fetch(t,e=!0,n=null){return"string"==typeof t?u.load(new URL(t,loaction),e,n):t instanceof URL?u.load(t,e,n):void new Error("The url isn't a allowed type! -> [String|URL] required!")}static async load(t,e=!0,n=null){if(t instanceof u)return t;const r=((t,e,n)=>{if(!e)return null;let r=null;return n?r=n:"string"==typeof t?r=t:t instanceof URL?r=t.toString():t instanceof HTMLElement&&(r=t.selector()),r?r.hashcode():null})(t,e,n);return r&&o[r]?o[r]:"string"==typeof t?l(t,e,r):t instanceof URL?await(async(t,e,n)=>{const r=await fetch(t.toString()),i=await r.text();return l(i,e,n)})(t,e,r):t instanceof Node||t instanceof NodeList||t instanceof HTMLCollection||t instanceof HTMLTemplateElement?c(t,e,r):void new Error("The template isn't a allowed type! -> [String|URL|Node|NodeList|HTMLCollection|Template] required!")}static async loadNodeTemplate(t,e,n,r){try{const e=(t=>{let e=t.find(":scope > template").first();if(e)return e;const n=t.attr("template");if(!n)return null;try{if(e=find(n).first(),e)return e}catch(t){}return new URL(n,location)})(t);if(e)return u.load(e,n,r)}catch(e){console.warn("Can't load template from node!",t,e)}return e}}n(979);var d=n(530),h=n(397);n(800),n(494);const p=[],f={init:0,data:1,template:2,content:3,finish:4};class E{static get PHASE(){return f}static get MIN_RANK(){return 0}static get MAX_RANK(){return 1e5}constructor(){}get name(){}get rank(){}get phase(){return f.finish}async execute(t){return t}static define(t){(({directive:t})=>{if(!(t instanceof E))throw new Error("Implementation dosn't extend Directive class!");if(t.rank<E.MIN_RANK)throw new Error("The rank of a directive can't be lower as "+E.MIN_RANK+"!");if(t.rank>E.MAX_RANK)throw new Error("The rank of a directive can't be grater as "+E.MAX_RANK+"!");p.push(t),p.sort(((t,e)=>{const n=t.phase-e.phase;return 0==n?t.rank-e.rank:n}))})(t)}static get directives(){return p}}new Set,new Map;const T=t=>t instanceof u?t.importContent():typeof t===String?create(t):t;let m=0;class g{#t;#e;#n;#r;#i;#a;#s;#o;#l;#c;#u;constructor({content:t=null,resolver:e,renderer:n,template:r,container:i,root:a,mode:s="replace",target:o=null,parent:l=null,wait:c=null,callbacks:u=null,ignoreDirective:d}){if(!e)throw new Error('Parameter "resolver" is required!');if(!n)throw new Error('Parameter "renderer" is required!');if(!r)throw new Error('Parameter "template" is required!');if(!i)throw new Error('Parameter "container" is required!');if(!a)throw new Error('Parameter "root" is required!');this.#t=l?`${l.id}->${m++}`:"root::"+m++,this.#e=l?l.depth+1:0,this.#n=l,this.#r=n,this.#i=a,this.#a=T(r),this.#s=s,this.#o=new Set,this.#l=c||(0,h.lazyPromise)(),this.#c=d instanceof Set?d:new Set,this.#u=u instanceof Array?u:[],this.content=t,this.container=i,this.target=o,this.resolver=e,this.stop=!1,this.ignore=!1,l&&l.subcontexts.add(this)}get id(){return this.#t}get depth(){return this.#e}get parent(){return this.#n}get renderer(){return this.#r}get root(){return this.#i}get template(){return this.#a}set template(t){this.#a=T(t)}get mode(){return this.#s}get subcontexts(){return this.#o}get closed(){return this.#l.resolved}ignoreDirective(t){const e=this.#c;t instanceof E?e.add(t.name):e.add(t)}acceptDirective(t){const e=this.#c;return t instanceof E?!(e.has(t.name)||e.has(t)):!e.has(t)}finished(t){this.parent?this.parent.finished(t):this.ready(t)}async ready(t){const e=this.#u;if(!t){const t=this.#l;if(!t.resolved){if(!this.ignore)for(let t of e)await t(this);for(let t of this.subcontexts)await t.ready();this.parent&&this.parent.subcontexts.delete(this),t.resolve(this)}return t}t instanceof Array?t.forEach((t=>this.wait.then(t))):t instanceof Promise?e.push((async()=>await t)):"function"==typeof t&&e.push(t)}subContext({resolver:t=this.resolver,renderer:e=this.renderer,template:n=this.template,container:r=this.container,root:i=this.root,mode:a=this.mode,target:s=this.target,ignoreDirective:o=null}={}){return new g({resolver:t,renderer:e,template:n,container:r,mode:a,root:i,target:s,parent:this,ignoreDirective:o})}clone({content:t=this.content,template:e=this.template,container:n=this.container,root:r=this.root,mode:i=this.mode,target:a=this.target,ignoreDirective:s=this.#c}={}){return new g({content:t,resolver:this.resolver,renderer:this.renderer,template:e,container:n,root:r,mode:i,target:a,ignoreDirective:s,wait:this.#l,callbacks:this.#u})}toRenderOption({resolver:t=this.resolver,renderer:e=this.renderer,template:n=this.template,container:r=this.container,root:i=this.root,mode:a=this.mode,target:s=this.target,ignoreDirective:o=null}={}){return{resolver:t,renderer:e,template:n,container:r,mode:a,root:i,target:s,parent:null,ignoreDirective:o}}}class A extends HTMLElement{constructor(){super(),this.hidden=!0}async execute({template:t,context:e}){return e.content=t.cloneNode(!0),e}}class v extends A{constructor(){super(),this.attachShadow({mode:"open"})}async execute({template:t,context:e}){return e}}try{customElements.define("jstl-replace",v)}catch(t){}E.define({directive:new class extends E{constructor(){super()}get name(){return"initial"}get rank(){return E.MIN_RANK}get phase(){return E.PHASE.init}async execute(t){const{template:e,renderer:n,resolver:r}=t;if(e instanceof Element)if(e.attr("jstl-ignore"))t.content=document.importNode(e,!0),t.stop=!0,t.ignore=!0;else if(e.attr("jstl-async")){t.content=new v,e.attr("jstl-async",null);const r=t.toRenderOption({mode:"replace",target:t.content});setTimeout((()=>{n.render(r)}),parseInt(e.attr("jstl-async")||"250")||250),t.stop=!0,t.ignore=!0}else if(e instanceof HTMLTemplateElement){t.content=document.createElement(e.tagName);const r=t.subContext({template:e.content.childNodes,container:t.content.content});await n.render(r),t.stop=!0,t.ignore=!0}else if(e.hasAttribute("jstl-tagname"))e.attr("jstl-tagname").trim().length>0?t.content=document.createElement(await r.resolveText(e.attr("jstl-tagname"))):(t.content=document.importNode(e,!0),t.stop=!0,t.ignore=!0);else if(e.tagName){let n=e.attr("is");if(n){n=await r.resolveText(n);const i=document.createElement(e.tagName,{is:n});i.attr("is",n),t.content=i}else t.content=document.createElement(e.tagName)}else t.content=document.importNode(e,!0),t.stop=!0,t.ignore=!0;else t.content=document.importNode(e,!0);return t}}});const N={remote:async({data:t,context:e})=>{const{resolver:n,template:r}=e;t=await n.resolveText(t),t=new URL(t,location.origin);let i=await n.resolveText(r.attr("jstl-data-option")||"{}");return i=JSON.parse(i),(t=await fetch(t.toString(),i)).json()},set:async({data:t,context:e})=>{const{resolver:n}=e;return await n.resolve(t)},direct:async({data:t,context:e})=>{const{resolver:n}=e;return await n.resolveText(t)}};E.define({directive:new class extends E{constructor(){super()}get name(){return"data"}get rank(){return 1e3}get phase(){return E.PHASE.data}async execute(t){if(!(t.template instanceof HTMLElement&&t.template.attr("jstl-data")))return t;try{const{template:e}=t,n=N[e.attr("jstl-data-mode")||"remote"];if(!n)throw new Error("The jstl-data-mode is unsupported!");let r=e.attr("jstl-data");r=await n({data:r,context:t});t=(({varname:t,data:e,scope:n,context:r})=>{if(t)r.resolver.updateData(t,e,n);else if(n)r.resolver.mergeContext(e,n);else{const t=new d.default({context:e,name:"jstl-data",parent:r.resolver});r.resolver=t}return r})({varname:e.attr("jstl-data-var"),data:r,scope:e.attr("jstl-data-scope"),context:t})}catch(e){console.error(e,t.template)}return t}}}),E.define({directive:new class extends E{constructor(){super()}get name(){return"if"}get rank(){return E.MIN_RANK+1e3}get phase(){return E.PHASE.init}async execute(t){const{template:e}=t;if(!(e instanceof HTMLElement&&e.attr("jstl-if")))return t;const n=e.attr("jstl-if"),r=t.resolver;return await r.resolve(n,!1)||(t.content=null,t.stop=!0,t.ignore=!0),t}}}),E.define({directive:new class extends E{constructor(){super()}get name(){return"choose"}get rank(){return E.MIN_RANK+1}get phase(){return E.PHASE.template}async execute(t){if(!(t.template instanceof HTMLElement&&t.template.hasAttribute("jstl-choose")&&0!=t.template.children.length))return t;t.template=t.template.cloneNode(!0);const{template:e,resolver:n}=t;let r=!1;const i=e.find(":scope > [jstl-when]"),a=i.length;for(let t=0;t<a;t++){const e=i[t];!r&&await n.resolve(e.attr("jstl-when"),!1)?r=!0:e.remove()}return r&&e.find(":scope > [jstl-otherwise]").remove(),t}}}),E.define({directive:new class extends E{constructor(){super()}get name(){return"include"}get rank(){return E.MIN_RANK}get phase(){return E.PHASE.template}async execute(t){if(!(t.template instanceof HTMLElement&&t.template.attr("jstl-include")))return t;try{const{template:e,resolver:n,renderer:r}=t;let i=e.attr("jstl-include");i=await n.resolveText(i),i=new URL(i,location),i=await u.load(i);const a=e.attr("jstl-include-mode")||"replace",s=t.subContext({template:i,container:t.content,mode:a});return await r.render(s),await s.ready(),t.ignore=!0,t.stop=!0,t}catch(e){return console.error(e,t.template),t}}}});const y="jstl-foreach",I="jstl-foreach-count",_=async(t,e)=>{let{template:n,resolver:r,renderer:i,container:a,condition:s,context:o}=e;if(r=new d.default({context:t,name:"jstl-foreach",parent:r}),s=!!s&&await r.resolve(s,!1),s)return!1;const l=o.subContext({resolver:r,container:a,template:n,mode:"append"});return await i.render(l),await l.ready(),!0};E.define({directive:new class extends E{constructor(){super()}get name(){return"foreach"}get rank(){return E.MIN_RANK+2}get phase(){return E.PHASE.template}async execute(t){if(!(t.template instanceof HTMLElement)||!t.template.attr(y)&&!t.template.attr(I))return t;t.ignore=!0;try{const{template:e,resolver:n,renderer:r,content:i}=t,a={data:(e.attr(y)||"").trim(),count:(e.attr(I)||"").trim(),start:await n.resolve(e.attr("jstl-foreach-start")||"0"),step:await n.resolve(e.attr("jstl-foreach-step")||"1"),varname:(e.attr("jstl-foreach-var")||"item").trim(),status:(e.attr("jstl-foreach-status")||"status").trim(),condition:e.attr("jstl-foreach-condition"),template:e.childNodes,resolver:n,renderer:r,container:i,context:t};a.data&&""!=a.data||!a.count?await(async t=>{let{data:e,start:n,step:r,count:i,varname:a,status:s,resolver:o}=t;e=await o.resolve(e);let l=e;e instanceof Array||(l=Object.getOwnPropertyNames(e)),i=""!=i?await o.resolve(i,0):null;const c=i?Math.min(n+i,l.length):l.length;let u=!1;for(let i=n;i<c&&!u;i+=r){const n={};n[a]=e[i],n[s]={index:i,number:i+1,count:c,data:e},u=!await _(n,t)}})(a):await(async t=>{let{start:e,step:n,count:r,varname:i,status:a,resolver:s}=t;r=await s.resolve(r);const o=e+r*n;let l=!1;for(let s=e;s<o&&!l;s+=n){const e={};e[i]=s,e[a]={index:s,number:s+1,step:n,count:r},l=!await _(e,t)}})(a)}catch(t){console.error("error at jstl-foreach:",t)}return t}}});const w="jstl-repeat",O=new Set([w]),R={DATA:`${w}`,VAR:`${w}-var`,STATUS:`${w}-status`,COUNT:`${w}-count`,START:`${w}-start`,STEP:`${w}-step`,CONDITION:`${w}-condition`},D=async(t,e)=>{let{template:n,resolver:r,renderer:i,condition:a,context:s}=e;if(r=new d.default({context:t,name:w,parent:r}),a=!!a&&await r.resolve(a,!1),a)return!1;const o=s.subContext({resolver:r,template:n,mode:"append",ignoreDirective:O});return await i.render(o),await o.ready(),!0};E.define({directive:new class extends E{constructor(){super()}get name(){return w}get rank(){return E.MIN_RANK+3}get phase(){return E.PHASE.template}async execute(t){if(!(t.template instanceof HTMLElement)||!t.template.attr(R.DATA)&&!t.template.attr(R.COUNT))return t;try{const{template:e,resolver:n,renderer:r,content:i,container:a}=t,s={data:(e.attr(R.DATA)||"").trim(),count:(e.attr(R.COUNT)||"").trim(),start:await n.resolve(e.attr(R.START)||"0"),step:await n.resolve(e.attr(R.STEP)||"1"),varname:(e.attr(R.VAR)||"item").trim(),status:(e.attr(R.STATUS)||"status").trim(),condition:e.attr(R.CONDITION),template:e,tagname:i.tagName,resolver:n,renderer:r,container:a,context:t};s.data&&""!=s.data||!s.count?await(async t=>{let{data:e,start:n,step:r,count:i,varname:a,status:s,resolver:o}=t;e=await o.resolve(e);let l=e;e instanceof Array||(l=Object.getOwnPropertyNames(e)),i=""!=i?await o.resolve(i,0):null;const c=i?Math.min(n+i,l.length):l.length;let u=!1;for(let i=n;i<c&&!u;i+=r){const n={};n[a]=e[i],n[s]={index:i,number:i+1,count:c,data:e},u=!await D(n,t)}})(s):await(async t=>{let{start:e,step:n,count:r,varname:i,status:a,resolver:s}=t;r=await s.resolve(r);const o=e+r*n;let l=!1;for(let s=e;s<o&&!l;s+=n){const e={};e[i]=s,e[a]={index:s,number:s+1,step:n,count:r},l=!await D(e,t)}})(s)}catch(t){console.error("error at jstl-repeat:",t)}return t.content=null,t.stop=!0,t.ignore=!0,t}}});const b={mode:"text",unsecure:!1,preventFormat:!1,maxLength:0},M={text:async(t,e)=>{const{content:n,resolver:r,template:i}=e;let a=await r.resolveText(i.textContent);a=create(a,!0).content.textContent,t.maxLength>0&&(a=((t,e)=>t.length>e?t.substring(0,e-3).trim()+"...":t)(a,t.maxLength)),n.textContent=a},html:async(t,e)=>{const{resolver:n,template:r}=e;let i=await n.resolveText(r.textContent);i=create(i,!0),i=document.importNode(i.content,!0),t.unsecure||i.find("script, style, body, html, head, object, link").remove(),e.content=i}};E.define({directive:new class extends E{constructor(){super()}get name(){return"text"}get rank(){return E.MIN_RANK+1}get phase(){return E.PHASE.content}async execute(t){const{template:e}=t;if(!(e instanceof Text)||0==e.textContent.trim().length||e.parentElement&&e.parentElement.hasAttribute("jstl-text-ignore"))return t;const n=e.parentElement,r=n?await(async(t,e)=>{const n=e.resolver;return{mode:await n.resolveText((t.attr("jstl-text-content-type")||"text").trim().toLowerCase()),unsecure:t.hasAttribute("jstl-text-unsecure"),preventFormat:!!t.attr("jstl-text-prevent-format")||!1,maxLength:parseInt(await n.resolveText(t.attr("jstl-text-trim-length")||"0"))}})(n,t):b,i=M[r.mode];if(!i)throw new Error('Text mode "'+r.mode+'" is unsupported!');return await i(r,t),t}}});var x=n(302);const V=/(jstl)?(\?)?(@)?([^\?@]+)/i,L="default",S="prevent-default",U=["is"],P={delegate:async(t,e,n,r,i,a,s,o)=>{const l=await i.resolveText(e,e);a.on(t,j(l,n))},toggleclass:async(t,e,n,r,i,a,s,o)=>{const l=s.shift(),c=s.includes(S),u=e?await i.resolveText(e,e):null;a.on(t,(t=>{c&&t.preventDefault(),u?a.closests(u).toggleClass(l):a.toggleClass(l)}))},toggleattribute:async(t,e,n,r,i,a,s,o)=>{const l=s.shift(),c=s.includes(S),u=e?await i.resolveText(e,e):null;a.on(t,(t=>{c&&t.preventDefault(),u?a.closests(u).forEach((t=>{t.toggleAttribute(l)})):a.toggleAttribute(l)}))},[L]:async(t,e,n,r,i,a,s,o)=>{const l=e?await i.resolve(e,e):null;if(l){if("function"==typeof l)a.on(t,l);else if("string"==typeof l)a.on(t,j(l,n));else if("object"==typeof l){const{capture:e=!1,passive:n=!1,once:r=!1}=l;a.on(t,l.eventHandle,{capture:e,passive:n,once:r})}}else console.error(new Error("Can't resolve \""+e+'" to event handle!'))}},C=async({condition:t,name:e,value:n,context:r})=>{const{resolver:i,content:a,template:s}=r;let o=t?s.attr(e):n;t=t?n:s.attr("?"+e);const l=B(o);t&&l?!0===(t=await i.resolve(t,!1))&&a.attr(e,await i.resolveText(o,o)):t?!0===(t=await i.resolve(t,!1))&&a.attr(e,!0):l&&a.attr(e,await i.resolveText(o,o))},B=t=>null!=t&&void 0!==t,F=async({condition:t,name:e,value:n,context:r})=>{const{resolver:i,template:a,content:s}=r;let o=(t=t?n:a.attr("?@"+e))?a.attr("@"+e):n,l=e.split("::");1==l.length&&(l=e.split(":"));const c=l.shift(),u=(l.shift()||L).toLowerCase();void 0!==o&&null!=o||console.error(`Definition of "${c}" - event handle at`,s,"is incorrect!"),o=o.trim();const d={bubble:!0};t?1==await i.resolve(t,!1)&&await H(c,o,d,u,i,s,l,r):await H(c,o,d,u,i,s,l,r)},H=async(t,e,n,r,i,a,s,o)=>{const l=P[r];if(l)return l(t,e,n,r,i,a,s,o)},j=function(t,e){return function(e){e.preventDefault(),e.stopPropagation(),e.currentTarget?e.currentTarget.trigger(t,e):e.target.trigger(t,e)}};E.define({directive:new class extends E{constructor(){super()}get name(){return"attribute"}get rank(){return E.MIN_RANK}get phase(){return E.PHASE.content}async execute(t){const{template:e}=t;if(!(e instanceof HTMLElement))return t;const n=new Set(U);for(const r of e.attributes){const[,e,i,a,s]=V.exec(r.name);if(!e&&!n.has(s)){const e=r.value;a?await F({condition:i,event:a,name:s,value:e,context:t}):await C({condition:i,name:s,value:e,context:t})}n.add(s)}return t}}});const $="jstl-attach-element",G="replace",z=/^#.+$/;E.define({directive:new class extends E{constructor(){super()}get name(){return"attach-element"}get rank(){return E.MIN_RANK+1}get phase(){return E.PHASE.content}async execute(t){const{resolver:e,template:n,content:r}=t;if(!(n instanceof HTMLElement&&n.attr($)))return t;try{let i=await(async(t,e)=>{let n=(t.attr($)||"").trim();if(!z.test(n)){try{n=await e.resolve(n,n)}catch(t){}if(n instanceof HTMLElement)return n}try{n=find(n)}catch(t){}return n&&n.length>0?0==n.length?n.first():n:null})(n,e);if(i){const e=n.attr("jstl-attach-element-mode")||G;e==G?(r.empty().append(i),t.stop=!0,t.ignore=!0):t.ready((({content:t})=>{t&&("append"==e?t.append(i):"prepend"==e&&t.prepend(i))}))}}catch(e){console.log(e,{context:t})}return t}}});const k="on-finished",W=`jstl-${k}`,Y=`${W}-async`;E.define({directive:new class extends E{constructor(){super()}get name(){return k}get rank(){return E.MAX_RANK}get phase(){return E.PHASE.finish}async execute(t){const{template:e,content:n,root:r}=t;if(!(e instanceof HTMLElement&&e.hasAttribute(W)))return t;const i=e.attr(W),a=e.hasAttribute(Y),s={$element:n,$root:r,$template:e},o=new d.default({context:s,name:"jstl-data",parent:t.resolver});return t.finished((async()=>{try{if(!a)return o.resolve(i,null);o.resolve(i,null)}catch(t){console.error(t)}})),t}}});const Z=new d.default({name:"application"}),q={replace:async({container:t,target:e=null,content:n})=>{e?e.replace(n):(t.empty(),t.append(n))},append:async({container:t,target:e=null,content:n})=>{e?e.after(n):t.append(n)},prepend:async({container:t,target:e=null,content:n})=>{e?e.before(n):t.prepend(n)}},K=async t=>{try{let{template:e,renderer:n}=t;e instanceof A?await e.execute(t):await X(t);const{ignore:r,content:i}=t;if(!r&&i){let{resolver:e}=t;const r=t.template.childNodes;if(r&&r.length>0){const a=new d.default({name:"container",context:null,parent:e}),s=await n.render(t.subContext({container:i,template:r,resolver:a}));await s.ready()}}t.content&&t.content.tagName&&"JSTL"==t.content.tagName&&(t.content=t.content.childNodes)}catch(e){console.error("error at render node:",e,t)}return t},X=async t=>{const e=E.directives,n=e.length;for(let r=0;r<n&&!t.stop;r++){const n=e[r];try{t.acceptDirective(n)&&await n.execute(t)}catch(e){console.error("error at directive:",e,n,t)}}return t};class Q{constructor({template:t,data:e}={}){if(t&&!(t instanceof u))throw new Error("template must be an instance of Template!");this.template=t,this.resolver=new d.default({name:"data",context:e||{},parent:Z})}async render(t){const e=t instanceof g;if(e){if(t.closed)throw new Error("calling with closed context",t)}else{let{template:e=null,data:n=null,container:r,root:i,mode:a,target:s}=t;e=await(async(t,e)=>{if(t)return(t=await u.load(t)).importContent();if(e.template)return await e.template.importContent();throw new Error("No content template specified!")})(e,this);const o=new d.default({name:"render",context:n,parent:this.resolver});t=new g({resolver:o,renderer:this,template:e,container:r,root:i||r,mode:a||"replace",target:s})}return t.template instanceof Node?await K(t):await(async t=>{let{template:e,resolver:n}=t;if(!e||0==e.length)return t;let r=[];for(let i of e){i.normalize();const e=new d.default({name:"node",context:null,parent:n}),a=await K(t.subContext({template:i,resolver:e}));await a.ready();const s=a.content;s&&(s instanceof Array&&(r=r.concat(s)),s instanceof NodeList||s instanceof HTMLCollection?r=r.concat(Array.from(s)):s instanceof Node&&r.push(s))}return t.content=0!=r.length?r:null,t})(t),await(async t=>{if(t.content){const e=q[t.mode];if(!e)throw new Error('The "'+t.mode+'" is not supported!');await e(t)}})(t),e||await t.ready(),t}static async build({template:t,data:e}={}){return t&&t instanceof Promise&&(t=await t),t=t?await u.load(t):null,new Q({template:t,data:e})}static async render({container:t,data:e,template:n,mode:r,target:i}){return new Q({template:n,data:e}).render({container:t,mode:r,target:i})}}const J=(()=>{try{return new URL("file:///C:/Users/Titus/git/defaultjs-html-form-tag-field/node_modules/@default-js/defaultjs-common-utils/src/ServiceHelper.js",location)}catch(t){}try{return new URL(document.currentScript.src,location)}catch(t){}return new URL(x.default.SERVICEURL,location)})(),tt=t=>(t=>{let e=null;return async()=>(e||(e=u.load(t)),e)})((()=>new URL(`${x.default.DEFAULTJS_HTML_FORM_FIELD__BASE_TEMPLATE_PATH||""}${t}`,J)));var et=n(257);const nt=i;class rt extends a.Component{static get NODENAME(){return nt}#d=!1;#h="true";constructor(){super()}async init(){await super.init(),this.#d||(this.#h=(this.attr("condition")||"").trim())}async validate(t){if(0==!this.#h.length)return!0;const e=await et.ExpressionResolver.resolve(this.#h,{$value:t},!1);return this.attr("active",e?null:""),e}}(0,a.define)(rt);const it=r,at=tt(`/${it}/root.tpl.html`),st=tt(`/${it}/item.tpl.html`),ot=`${it}:action:remove`,lt=`${it}:action:add-value`,ct="text",ut=[ct,"url","tel","email","number"],dt=[];class ht extends s.BaseField{static get observedAttributes(){return dt.concat(s.BaseField.observedAttributes)}static get NODENAME(){return it}#p=!1;#f=null;#E=[];#T=null;#m=new Set;#g=new Set;constructor(){super();const t=this.root;t.on(ot,(t=>{t.preventDefault(),t.stopPropagation();const e=t.target.parent("[tag-item]");if(e){const t=e.attr("tag-item-value");this.#g.delete(t),e.remove(),this.publishValue()}})),t.on(lt,(t=>{t.preventDefault(),t.stopPropagation();const e=this.#T,n=t.detail;(async()=>{n&&(e&&(e.value=null),this.#g.has(n)||(this.#g.add(n),this.#A(n),this.publishValue()))})()}))}async init(){if(!this.#p){const t=this.root;let e=(this.attr("type")||ct).trim().toLowerCase();ut.includes(e)||(e=ct);const n=this.attr("placeholder")||'Press "Enter" for value';await Q.render({container:t,data:{type:e,placeholder:n},template:await at(),mode:"prepend"}),this.#E=Array.from(t.find(i)),this.#f=t.find("[tag-container]").first();const r=this.#T=t.find("input").first();r.on("keypress",(t=>{const{keyCode:e,target:n}=t;n==r&&13==e&&(t.preventDefault(),t.stopPropagation(),(async()=>{const t=(r.value||"").trim();if(t.length<=0)return;r.setCustomValidity(""),await this.#v(t)||r.setCustomValidity("invalid"),r.checkValidity();const e=r.validity;e.valid&&this.trigger(lt,t),e.customError||r.reportValidity(),r.setCustomValidity("")})())}))}await super.init()}async#v(t){return!this.#E||!(await Promise.all(this.#E.map((e=>e.validate(t))))).includes(!1)}async readonlyUpdated(){await this.ready;const t=this.readonly;this.#T.attr("disabled",t?"":null)}async publishValue(){const t=this.#g&&this.#g.size>0?Array.from(this.#g):null;super.publishValue(t)}async#A(t){const e=this.#m,n=this.#f,r=await st();await Q.render({container:n,template:r,data:{isNew:!e.has(t),title:t,value:t},mode:"append"})}async#N(){const t=Array.from(this.#g);return this.#f.empty(),Promise.all(t.sort().map((t=>this.#A(t))))}async acceptValue(t){return null==t||void 0===t||t instanceof Array||t instanceof Set}async normalizeValue(t){return t?t.filter((t=>!!t)):null}async updatedValue(t){return await this.ready,t=await t||[],this.#m=new Set(t),this.#g=new Set(t),this.#N(),super.updatedValue(t)}}(0,a.define)(ht);const pt=ht},302:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>r});const r=void 0!==n.g?n.g:"undefined"!=typeof window?window:"undefined"!=typeof self?self:{}},127:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>r});class r{constructor(t,e){this.key=t,this.context=e}get keyDefined(){return this.key in this.context}get hasValue(){return!!this.context[this.key]}get value(){return this.context[this.key]}set value(t){this.context[this.key]=t}set append(t){if(this.hasValue){const e=this.value;e instanceof Array?e.push(t):this.value=[this.value,t]}else this.value=t}remove(){delete this.context[this.key]}static load(t,e,n=!0){let i=t;const a=e.split(".");let s=a.shift().trim();for(;a.length>0;){if(!i[s]){if(!n)return null;i[s]={}}i=i[s],s=a.shift().trim()}return new r(s,i)}}},800:(t,e,n)=>{"use strict";n.r(e),n.d(e,{append:()=>c,defGet:()=>p,defGetSet:()=>f,defValue:()=>h,default:()=>E,equalPojo:()=>o,filter:()=>d,isNullOrUndefined:()=>i,isObject:()=>s,isPojo:()=>l,isPrimitive:()=>a,merge:()=>u});var r=n(127);const i=t=>null==t||void 0===t,a=t=>{if(null==t)return!0;switch(typeof t){case"number":case"bigint":case"boolean":case"string":case"undefined":return!0}return!1},s=t=>!(i(t)||"object"!=typeof t||t.constructor&&"Object"!==t.constructor.name),o=(t,e)=>{const n=i(t),r=i(e);if(n||r)return t===e;if(a(t)||a(e))return t===e;const s=typeof t;return s==typeof e&&("function"===s?t===e:((t,e)=>{const n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(const r of n){const n=t[r],i=e[r];if(!o(n,i))return!1}return!0})(t,e)&&((t,e)=>{const n=Object.getPrototypeOf(t),r=Object.getPrototypeOf(e);if(n!=r)return!1;if(!n)return!0;const i=Object.getOwnPropertyNames(n),a=Object.getOwnPropertyNames(r);if(i.length!==a.length)return!1;for(const n of i){const r=t[n],i=e[n];if(!o(r,i))return!1}return!0})(t,e))},l=t=>{if(!s(t))return!1;for(const e in t)if("function"==typeof t[e])return!1;return!0},c=function(t,e,n){return void 0!==e&&(r.default.load(n,t,!0).append=e),n},u=function(t,...e){t||(t={});for(let n of e)l(n)&&Object.getOwnPropertyNames(n).forEach((e=>{l(t[e])?u(t[e],n[e]):t[e]=n[e]}));return t},d=function(){const[t,e,{deep:n=!1,recursive:r=!0,parents:i=[]}={}]=arguments,a={};for(let s in t){const o=t[s],l=e(s,o,t);!l||n&&null!=o?l&&n&&("object"!=typeof o||o instanceof Array||o instanceof Map||o instanceof Set||o instanceof RegExp||i.includes[o]||o==t?a[s]=o:a[s]=d(o,e,{deep:n,recursive:r,parents:i.concat(t)})):a[s]=o}return a},h=(t,e,n)=>{Object.defineProperty(t,e,{value:n,writable:!1,configurable:!1,enumerable:!1})},p=(t,e,n)=>{Object.defineProperty(t,e,{get:n,configurable:!1,enumerable:!1})},f=(t,e,n,r)=>{Object.defineProperty(t,e,{get:n,set:r,configurable:!1,enumerable:!1})},E={isNullOrUndefined:i,isObject:s,equalPojo:o,isPojo:l,append:c,merge:u,filter:d,buildPropertyFilter:function({names:t,allowed:e}){return(n,r,i)=>t.includes(n)===e},defValue:h,defGet:p,defGetSet:f}},494:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>o,privateProperty:()=>a,privatePropertyAccessor:()=>s,privateStore:()=>i});const r=new WeakMap,i=t=>{if(r.has(t))return r.get(t);const e={};return r.set(t,e),e},a=function(t,e,n){const r=i(t);if(1===arguments.length)return r;if(2===arguments.length)return r[e];if(3!==arguments.length)throw new Error("Not allowed size of arguments!");r[e]=n},s=t=>function(e,n){if(2!=arguments.length)return a(e,t);a(e,t,n)},o={privateProperty:a,privatePropertyAccessor:s,privateStore:i}},397:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>s,lazyPromise:()=>a,timeoutPromise:()=>i});var r=n(800);const i=(t,e)=>{let n=!1,i=null;const a=new Promise(((n,r)=>{i=setTimeout((()=>{i=null,t(n,r)}),e)})),s=a.then;return a.then=t=>{s.call(a,(e=>{if(!(void 0).canceled)return t(e)}))},(0,r.defValue)(a,"cancel",(()=>{i&&(clearTimeout(i),n=!0)})),(0,r.defGet)(a,canceld,(()=>n)),a},a=()=>{let t=null,e=null;const n=new Promise(((n,r)=>{t=n,e=r}));let i,a=!1,s=!1;return(0,r.defValue)(n,"resolve",(n=>{i=n,a=!0,i instanceof Error?(s=!0,e(i)):t(i)})),(0,r.defGet)(n,"value",(()=>i)),(0,r.defGet)(n,"error",(()=>s)),(0,r.defGet)(n,"resolved",(()=>a)),n},s={lazyPromise:a,timeoutPromise:i}},609:()=>{String.prototype.hashcode||(String.prototype.hashcode=function(){if(0===this.length)return 0;let t=0;const e=this.length;for(let n=0;n<e;n++)t=(t<<5)-t+this.charCodeAt(n),t|=0;return t})},257:(t,e,n)=>{"use strict";n.r(e),n.d(e,{Context:()=>i.default,ExpressionResolver:()=>r.default});var r=n(530),i=n(722)},722:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>i});class r{constructor(t,e){this.data=t,this.resolver=e,this.cache=new Map}updateData(t){this.data=t,this.cache=new Map}resetCache(){this.cache=new Map}getPropertyDef(t,e=!0){if(this.cache.has(t))return this.cache.get(t);let n=null;if(this.data&&t in this.data)n={data:this.data,resolver:this.resolver,defined:!0};else{if(!e)return null;n=((t,e)=>{for(;t;){const n=t.proxy.handle.getPropertyDef(e,!1);if(n)return n;t=t.parent}return{data:null,resolver:null,defined:!1}})(this.resolver.parent,t)}return n.defined&&this.cache.set(t,n),n}hasProperty(t){const{defined:e}=this.getPropertyDef(t);return e}getProperty(t){const{data:e}=this.getPropertyDef(t);return e?e[t]:void 0}setProperty(t,e){const{data:n,defined:r}=this.getPropertyDef(t);r?n[t]=e:(this.data||(this.data={}),this.data[t]=e,this.cache.set(t,{data:this.data,resolver:this.resolver,defined:!0}))}deleteProperty(t){throw new Error("unsupported function!")}}class i{constructor(t,e){this.handle=new r(t,e),this.data=new Proxy(this.handle,{has:function(t,e){return t.hasProperty(e)},get:function(t,e){return t.getProperty(e)},set:function(t,e,n){return t.setProperty(e,n)},deleteProperty:function(t,e){return t.deleteProperty(e)}})}updateData(t){this.handle.updateData(t)}resetCache(){this.handle.resetCache()}}},530:(t,e,n)=>{"use strict";n.r(e),n.d(e,{default:()=>f});var r=n(302),i=n(127),a=n(800);class s{constructor(t){this.hasValue=1==arguments.length,this.value=t}}var o=n(722);const l=/(\\?)(\$\{(([a-zA-Z0-9\-_\s]+)::)?([^\{\}]+)\})/,c=new s,u=t=>t instanceof s?t:new s(t),d=async function(t,e,n,r){if(n&&t.name!=n)return t.parent?d(t.parent,e,n,r):null;const i=await async function(t,e){if("string"!=typeof t)return t;const n=new Function("context",`\nreturn (async (context) => {\n\ttry{ \n\t\twith(context){\n\t\t\t return ${t}\n\t\t}\n\t}catch(e){\n\t\tthrow e;\n\t}\n})(context)`);let r,i=setTimeout((()=>{i=null,console.warn("long running statement:",t,new Error)}),1e3);try{r=await n(e)}catch(t){}return i&&clearTimeout(i),r}(e,t.proxy.data);return null!=i?i:r instanceof s&&r.hasValue?r.value:void 0},h=async(t,e,n)=>e[1]?e[2]:d(t,e[5],p(e[4]),n),p=t=>t?0==(t=t.trim()).length?null:t:null;class f{constructor({context:t=r.default,parent:e=null,name:n=null}){this.parent=e instanceof f?e:null,this.name=n,this.context=t,this.proxy=new o.default(this.context,this)}get chain(){return this.parent?this.parent.chain+"/"+this.name:"/"+this.name}get effectiveChain(){return this.context?this.parent?this.parent.effectiveChain+"/"+this.name:"/"+this.name:this.parent?this.parent.effectiveChain:""}get contextChain(){const t=[];let e=this;for(;e;)e.context&&t.push(e.context),e=e.parent;return t}getData(t,e){if(t){if(!e||e==this.name){const e=i.default.load(this.context,t,!1);return e?e.value:null}this.parent&&this.parent.getData(t,e)}}updateData(t,e,n){t&&(n&&n!=this.name?this.parent&&this.parent.updateData(t,e,n):(null!=this.context&&void 0!==this.context||(this.context={},this.proxy.updateData(this.context)),i.default.load(this.context,t).value=e,this.proxy.resetCache()))}mergeContext(t,e){e&&e!=this.name?this.parent&&this.parent.mergeContext(t,e):this.context=this.context?a.default.merge(this.context,t):t}async resolve(t,e){const n=2==arguments.length?u(e):c;try{const e=l.exec(t);return e?await h(this,e,n):await d(this,p(t),null,n)}catch(e){return console.error('error at executing statment"',t,'":',e),n.hasValue?n.value:t}}async resolveText(t,e){let n=t,r=t,i=l.exec(n);const a=2==arguments.length?u(e):c;for(;null!=i;){const t=await h(this,i,a);r=r.split(i[0]).join(),n=n.split(i[0]).join(void 0===t?"undefined":null==t?"null":t),i=l.exec(r)}return n}static async resolve(t,e,n,r){const i=new f({context:e}),a=arguments.length>2?u(n):c;return"number"==typeof r&&r>0?new Promise((e=>{setTimeout((()=>{e(i.resolve(t,a))}),r)})):i.resolve(t,a)}static async resolveText(t,e,n,r){const i=new f({context:e}),a=arguments.length>2?u(n):c;return"number"==typeof r&&r>0?new Promise((e=>{setTimeout((()=>{e(i.resolveText(t,a))}),r)})):i.resolveText(t,a)}static buildSecure({context:t,propFilter:e,option:n={deep:!0},name:r,parent:i}){return t=a.default.filter({data:t,propFilter:e,option:n}),new f({context:t,name:r,parent:i})}}},979:(t,e,n)=>{"use strict";n.r(e);const r=function(){const t=Array.from(arguments),e=t.shift();for(;t.length>0;)t.shift()(e)},i={global:"undefined"!=typeof window?window:void 0!==n.g?n.g:"undefined"!=typeof self?self:{},globalVar:function(t,e){return 2===arguments.length&&void 0===i.global[t]&&(i.global[t]=e),i.global[t]}},a=i,s=a.globalVar("___DOM_API_EXTENSION_MAP___",{}),o=function(t,e){return function(n){let r=s[n.name];r||(r=s[n.name]={}),r[t]?console.warn('duplicated load of extension "'+t+'"!'):(r[t]=!0,e(n.prototype))}},l=o("EventSupport",(t=>{const e=/(\s+)|(\s*,\s*)/,n=t=>(t.__wrapperhandlemap__||(t.__wrapperhandlemap__=new Map),t.__wrapperhandlemap__),r=(t,r,i)=>{const{wrapper:a,option:s,events:o,handle:l}=r,c=s.capture;if(i){i="string"==typeof i?i.split(e):i;for(let e of i){const r=o.indexOf(e);r>=0&&(t.removeEventListener(e,a,c),o.splice(r,1)),0==o.length&&n(t).delete(l)}}else{for(let e of o)t.removeEventListener(e,a,c);n(t).delete(l)}};t.on=function(){if(arguments.length<2)throw new Error("Too less arguments!");const t=Array.from(arguments);let i="string"==typeof t[0]?t.shift().split(e):t.shift();const a="string"==typeof t[0]?t.shift():null,s=t.shift(),o=void 0===t[0]?{capture:!1,once:!1,passive:!1}:"boolean"==typeof t[0]?{capture:t.shift(),once:!1,passive:!1}:t.shift(),l=function(t){if(a){const e=t.target;if("function"==typeof e.is&&!e.is(a))return}const e=s.apply(null,arguments);return o.once&&r(this,l),e};n(this).set(s,{handle:s,wrapper:l,events:i,option:o});for(let t of i)this.addEventListener(t,l,o);return this},t.removeOn=function(t,e,i){const a=n(this).get(t);return a?r(this,a,e):this.removeEventListener(t,e,i),this},t.trigger=function(){const t=Array.from(arguments),e="number"==typeof t[0]?t.shift():-1;if(e>=0){const n=t[0],r=(this.___EVENTTRIGGERTIMEOUTS___||(this.___EVENTTRIGGERTIMEOUTS___={}),this.___EVENTTRIGGERTIMEOUTS___),i=r[n];i&&clearTimeout(i),r[n]=setTimeout((()=>{delete r[n],this.trigger.apply(this,t)}),e)}else{const e=t.shift(),n=t[0]instanceof Event?t.shift():null,r=t.length>=1?1==t.length?t.shift():t:n,i=r?new CustomEvent(e,{bubbles:!0,cancelable:!0,composed:!0,detail:r}):new Event(e,{bubbles:!0,cancelable:!0,composed:!0});n&&(i.delegatedEvent=n),this.dispatchEvent(i)}return this}}));r(EventTarget,l);const c=o("DataSupport",(t=>{t.data=function(){const t={};if(void 0!==this.dataset)for(name in this.dataset)t[name]=this.dataset[name];return this.data=function(){return 0==arguments.length?t:1==arguments.length?t[arguments[0]]:(void 0===arguments[1]||null==arguments[1]?delete t[arguments[0]]:t[arguments[0]]=arguments[1],this)}.bind(this),this.data.apply(null,arguments)}})),u=o("ManipulationSupport",(t=>{t.empty=function(){let t=this.childNodes;for(;0!=t.length;)t[0].remove(!0);return this},t.content=function(){return this.childNodes},t.html=function(){return 0==arguments.length?this.innerHTML:1==arguments.length&&"boolean"==typeof arguments[0]?arguments[0]?this.outerHTML:this.innerHTML:(Array.from(arguments).forEach((t=>{this.empty(),("string"==typeof t||t instanceof Node||t instanceof NodeList||t instanceof HTMLCollection)&&this.append(t)})),this)};const e=function(){const e=t.appendChild.bind(this);for(let t=0;t<arguments.length;t++){let n=arguments[t];n instanceof Node?this.appendChild(n):"string"==typeof n?create(n).forEach(e):"function"==typeof n.forEach&&n.forEach(e)}};t.append=e;const n=function(t,e){this.insertBefore(e,t)};t.prepend=function(){if(0==this.childNodes.length)e.apply(this,arguments);else{const t=this.childNodes.first(),e=n.bind(this,t);for(let t=0;t<arguments.length;t++){const n=arguments[t];n instanceof Node?e(n):("string"==typeof n||"function"==typeof n.forEach)&&n.forEach(e)}}},t.replace=function(){if(arguments.length<1)throw new Error("Insufficient arguments! One or two nodes required!");const t=1==arguments.length?this.parentNode:this,e=1==arguments.length?this:arguments[0],n=1==arguments.length?arguments[0]:arguments[1];n instanceof Array||n instanceof NodeList||n instanceof HTMLCollection?(n.forEach((n=>t.insertBefore(n,e))),e.remove()):t.replaceChild(n,e)},t.after=function(){if(null==this.parentNode)throw new Error("Can't insert nodes after this node! Parent node not available!");const e=this.parentNode,n=this.nextSibling;n?t.before.apply(n,arguments):t.append.apply(e,arguments)},t.before=function(){if(null==this.parentNode)throw new Error("Can't insert nodes after this node! Parent node not available!");const t=this.parentNode,e=e=>{t.insertBefore(e,this)};for(let t=0;t<arguments.length;t++){const n=arguments[t];n instanceof Node?e(n):("string"==typeof n||"function"==typeof n.forEach)&&n.forEach(e)}}}));r(Node,c,u);const d=/:parent(\(\"([^\)]*)\"\))?/i,h=function(t,e){let n=d.exec(e);if(!n)return t.querySelectorAll(e);{let r=t;if(n.index>0&&(r=t.querySelectorAll(e.substr(0,n.index)),0==r.length))return;if(r=r.parent(n[2]),r){let t=e.substr(n.index+n[0].length).trim();return t.length>0&&(r=r.find(t)),r}}},p=o("QuerySupport",(t=>{t.find=function(){let t=[],e=Array.from(arguments),n=e.shift();for(;n;){if("string"==typeof n){let e=h(this,n);e&&t.push(e)}n=e.shift()}return NodeList.from.apply(null,t)},t.is=function(){if(this instanceof Document||this instanceof DocumentFragment)return!1;if(1==arguments.length){if("string"==typeof arguments[0])return this.matches(arguments[0]);if("number"==typeof arguments[0].length){let t=arguments[0];for(let e=0;e<t.length;e++)if(this.matches(t[e]))return!0}}else if(arguments.length>1)return this.is(Array.from(arguments));return!1},t.parent=function(t,e){if(!this.parentNode)return null;e="boolean"==typeof t?t:e,t="string"==typeof t?t:null;let n=this.parentNode;if(n instanceof ShadowRoot&&e&&(n=n.host),t){try{for(;n&&!n.is(t);)n=n.parent(t,e)}catch(t){console.error("this:",this,"parent:",n,"error:",t)}return n}return n},t.parents=function(){let e=new Array,n=t.parent.apply(this,arguments);for(;n;)e.push(n),n=t.parent.apply(n,arguments);return NodeList.from(e)},t.selector=function(){if(!(this instanceof Document||this instanceof DocumentFragment)){if(this.id)return"#"+this.id;{let t=this.tagName.toLowerCase(),e=this.parent();if(e){let n=e.find(":scope>"+t);if(n instanceof NodeList){let e=n.indexOf(this);e>0&&(t+=":nth-child("+(e+1)+")")}let r=e.selector();return r?r+">"+t:t}return t}}},t.closest=function(t){return this.closests(t).first()},t.closests=function(t){const e=this.find(t);if(0!=e.length)return e;const n=this.parentElement;return n?n.closests(t):NodeList.from([])},t.nested=function(t){if(this.is(t))return NodeList.from(this);let e=this.find(t);return e&&e.length>0?e:NodeList.from(this.parent(t))}})),f=p,E=o("AttributeSupport",(t=>{t.attr=function(){return 0==arguments.length?this.hasAttributes()?(()=>{const t={};return this.getAttributeNames().forEach((e=>{t[e]=this.getAttribute(e)})),t})():void 0:1==arguments.length?this.getAttribute(arguments[0]):(void 0===arguments[1]||null==arguments[1]?this.removeAttribute(arguments[0]):this.setAttribute(arguments[0],arguments[1]),this)}}));r(Element,f,E,u);const T=o("ReadyEventSupport",(t=>{t.ready=function(t,e){return this.on("ready",t,e),"complete"==document.readyState&&this.trigger("ready"),this}}));r(Document,f,T),document.addEventListener("DOMContentLoaded",(()=>document.trigger("ready"))),r(DocumentFragment,f,u);const m=o("HtmlClassSupport",(t=>{t.addClass=function(){return 1==arguments.length?arguments[0].split(/\s+/).forEach((t=>this.classList.add(t))):arguments.length>1&&Array.prototype.forEach.call(arguments,(t=>this.classList.add(t))),this},t.removeClass=function(){return 1==arguments.length?arguments[0].split(/\s+/).forEach((t=>this.classList.remove(t))):arguments.length>1&&Array.prototype.forEach.call(arguments,(t=>this.classList.remove(t))),this},t.toggleClass=function(){return 1==arguments.length?arguments[0].split(/\s+/).forEach((t=>this.classList.toggle(t))):arguments.length>1&&Array.prototype.forEach.call(arguments,(t=>this.classList.toggle(t))),this}})),g="none",A=t=>t.style.display===g,v=t=>{let e=A(t)?"":t.style.display;return t.show=function(){return this.style.display=e,this}.bind(t),t.hide=function(){return this.style.display=g,this}.bind(t),t},N=o("ShowHideSupport",(t=>{t.show=function(){return v(this).show.apply(null,arguments)},t.hide=function(){return v(this).hide.apply(null,arguments)},t.toggleShow=function(){return A(this)?this.show():this.hide()}}));r(HTMLElement,m,N);const y=[{selector:"select",get:function(){const t=[];return this.find("option").forEach((e=>{e.selected&&t.push(e.value)})),t},set:function(){let t=[];const e=Array.from(arguments);let n=e.shift();for(;n;)Array.isArray(n)?t=t.concat(n):t.push(n),n=e.shift();this.value=t,this.find("option").forEach((e=>e.selected=t.indexOf(e.value)>=0)),this.trigger("changed")}},{selector:'input[type="checkbox"], input[type="radio"]',get:function(){return"on"==this.value||"off"==this.value?this.checked:this.checked?this.value:void 0},set:function(t){"boolean"==typeof t?this.checked=t:"string"==typeof t?this.checked=this.value==t:Array.isArray(t)&&(this.checked=t.indexOf(this.value)>=0),this.trigger("changed")}}],I={get:function(){return this.value},set:function(t){this.value=t,this.trigger("input")}},_=o("ValueSupport",(t=>{t.val=function(){let t=function(t){for(let e=0;e<y.length;e++)if(t.is(y[e].selector))return y[e];return I}(this);return 0==arguments.length?t.get.apply(this,arguments):(t.set.apply(this,arguments),this)}}));r(HTMLInputElement,_),r(HTMLTextAreaElement,o("ValueSupport",(t=>{t.val=function(){return 0==arguments.length?this.value:(this.value=arguments[0],this)}}))),r(HTMLSelectElement,_);const w=function(){const t=Array.from(arguments),e=t.shift(),n=t.shift();t.forEach((t=>{Object.getOwnPropertyNames(t).forEach((r=>{const i=Object.getOwnPropertyDescriptor(t,r);void 0===n[r]&&"function"==typeof i.value&&(n[r]=function(){return e.call(this,r,arguments)})}))}))},O=o("ListSupport",(t=>{t.indexOf=function(){for(let t=0;t<this.length;t++)if(this[t]==arguments[0])return t;return-1},t.forEach=function(){return Array.prototype.forEach.apply(Array.from(this),arguments)},t.map=function(){return Array.prototype.map.apply(Array.from(this),arguments)},t.filter=function(){return Array.prototype.filter.apply(Array.from(this),arguments)},t.first=function(){if(this.length>0)return this[0]},t.last=function(){if(this.length>0)return this[this.length-1]}}));r(NodeList,O),NodeList.prototype.applyTo=function(){const t=Array.from(arguments),e=t.shift(),n="function"==typeof e,r=[];for(let i=0;i<this.length;i++){const a=this[i];let s;n?s=e.apply([a].concat(t)):"function"==typeof a[e]&&(s=a[e].apply(a,t)),s&&r.push(s)}return r},NodeList.prototype.val=function(){if(0==arguments.length){if(this.length>0){const t=new Map;return this.forEach((e=>{"function"==typeof e.val&&e.val()&&t.set(e.name||e.id||e.selector(),e.val())})),t}}else NodeList.prototype.applyTo.apply(this,["val"].concat(Array.from(arguments)))},NodeList.from=function(){const t=Array.from(arguments),e={};let n=0;for(;t.length>0;){const r=t.shift();if(void 0!==r&&null!=r)if(r instanceof Node)e[n++]={value:r,enumerable:!0};else if(r instanceof NodeList||r instanceof HTMLCollection||r instanceof Array)for(let t=0;t<r.length;t++)r[t]&&r[t]instanceof Node&&(e[n++]={value:r[t],enumerable:!0})}return e.length={value:n},Object.create(NodeList.prototype,e)},w((function(t,e){let n=[];return this.forEach((r=>{if(r&&"function"==typeof r[t]){const i=r[t].apply(r,e);i&&(i instanceof NodeList?n=n.concat(Array.from(i)):n.push(i))}})),0===n.length?void 0:n[0]instanceof Node||n[0]instanceof NodeList?NodeList.from(n):n}),NodeList.prototype,Node.prototype,HTMLElement.prototype,HTMLInputElement.prototype,Element.prototype,EventTarget.prototype),r(HTMLCollection,O),HTMLCollection.prototype.applyTo=function(){const t=Array.from(arguments),e=t.shift(),n="function"==typeof e,r=[];for(let i=0;i<this.length;i++){const a=this[i];let s;n?s=e.apply([a].concat(t)):"function"==typeof a[e]&&(s=a[e].apply(a,t)),s&&r.push(s)}return r},HTMLCollection.prototype.val=function(){if(0==arguments.length){if(this.length>0){const t=new Map;return this.forEach((e=>{"function"==typeof e.val&&e.val()&&t.set(e.name||e.id||e.selector(),e.val())})),t}}else HTMLCollection.prototype.applyTo.apply(this,["val"].concat(Array.from(arguments)))},HTMLCollection.from=function(){const t=Array.from(arguments),e={};let n=0;for(;t.length>0;){const r=t.shift();if(void 0!==r&&null!=r)if(r instanceof HTMLElement)e[n++]={value:r,enumerable:!0};else if(r instanceof HTMLCollection||r instanceof NodeList||r instanceof Array)for(let t=0;t<r.length;t++)r[t]&&r[t]instanceof HTMLElement&&(e[n++]={value:r[t],enumerable:!0})}return e.length={value:n},Object.create(HTMLCollection.prototype,e)},w((function(t,e){let n=[];return this.forEach((r=>{if(r&&"function"==typeof r[t]){let i=r[t].apply(r,e);i&&(i instanceof HTMLCollection?n=n.concat(Array.from(i)):n.push(i))}})),0===n.length?void 0:n[0]instanceof HTMLElement||n[0]instanceof HTMLCollection?HTMLCollection.from.apply(null,n):n}),HTMLCollection.prototype,Node.prototype,HTMLElement.prototype,HTMLInputElement.prototype,Element.prototype,EventTarget.prototype),a.global.defaultjs=a.global.defaultjs||{},a.global.defaultjs.extdom=a.global.defaultjs.extdom||{VERSION:"1.0.0",utils:{Utils:a}},a.global.find=function(){return document.find.apply(document,arguments)},a.global.ready=function(){return document.ready.apply(document,arguments)},a.global.create=function(t,e){if("string"!=typeof arguments[0])throw new Error("The first argument must be a string!");const n=document.createElement("template");return n.innerHTML=t,e?n:document.importNode(n.content,!0).childNodes},a.global.script=function(t,e){return t instanceof Array?Promise.all(t.map((t=>a.global.script(t,e)))):"string"==typeof t?new Promise(((n,r)=>{const i=document.createElement("script");i.async=!0,i.onload=function(){n()},i.onerror=function(){throw new Error("load error!")},e?e.append(i):document.body.append(i),i.src=t})):Promise.reject("First parameter must be an array of strings or a string!")}},303:(t,e,n)=>{"use strict";n.r(e),n.d(e,{Component:()=>r.default,componentBaseOf:()=>r.componentBaseOf,define:()=>i});var r=n(243);n(471);const i=function(t,e){const n=t.NODENAME;customElements.get(n)||customElements.define(n,t,e)}},243:(t,e,n)=>{"use strict";n.r(e),n.d(e,{componentBaseOf:()=>d,createUID:()=>l,default:()=>h});var r=n(397);const i=()=>{const t=new Uint32Array(4);window.crypto.getRandomValues(t);let e=-1;return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(n=>{e++;const r=t[e>>3]>>e%8*4&15;return("x"==n?r:3&r|8).toString(16)}))};var a=n(471);const s=(t,e)=>{let n="unsupported";if("string"==typeof e)n=e;else if(e instanceof HTMLElement)n=e.nodeName;else{if("string"!=typeof e.NODENAME)throw new Error(typeof e+' is not supported as parameter "node"!');n=e.NODENAME}return`${n.toLowerCase()}:${t}`},o=new WeakMap,l=(t,e)=>{let n=0,r=null;for(;n<100;){if(r=`${t||""}${i()}${e||""}`,!document.getElementById(r))return r;n++}return console.error(new Error("To many retries to create an unique id - created id is not unique!")),r},c=t=>class extends t{#y=(0,r.lazyPromise)();constructor({shadowRoot:t=!1,content:e=null,createUID:n=!1,uidPrefix:r="id-",uidSuffix:i=""}={}){super(),n&&this.attr("id",n(r,i)),t&&this.attachShadow({mode:"open"}),e&&this.root.append("function"==typeof e?e(this):e)}get root(){return this.shadowRoot||this}get ready(){return this.#y}async init(){}async destroy(){this.ready.resolved&&(this.#y=(0,r.lazyPromise)())}connectedCallback(){this.ownerDocument==document&&this.isConnected&&(t=>{let e=o.get(t);e&&clearTimeout(e),o.get(t,setTimeout((async()=>{o.delete(t);try{await t.init(),t.ready.resolve()}catch(e){console.error("Can't initialize component!",t,e),t.ready(resolve(e))}t.trigger(s("initialzed",t))}),a.initTimeout))})(this)}adoptedCallback(){this.connectedCallback()}attributeChangedCallback(t,e,n){var r,i;e!=n&&this.isConnected&&(this.trigger(a.triggerTimeout,(r=t,i=this,s(`${a.attributeChangeEventPrefix}-${r}`,i))),this.trigger(a.triggerTimeout,s("change",this)))}disconnectedCallback(){this.destroy()}},u=new Map,d=t=>{let e=u.get(t);return null==e&&(e=c(t),u.set(t,e)),e},h=d(HTMLElement)},471:(t,e,n)=>{"use strict";n.r(e),n.d(e,{attributeChangeEventPrefix:()=>i,componentPrefix:()=>r,initTimeout:()=>a,triggerTimeout:()=>s});const r="d-",i="attribute-",a=10,s=10},892:(t,e,n)=>{"use strict";n.r(e),n.d(e,{BaseField:()=>w,BaseSubmitAction:()=>Vt,Container:()=>Z,Field:()=>j,Form:()=>Ht,List:()=>lt,Page:()=>dt,SubmitActionResult:()=>bt});var r=n(330),i=n(243),a=n(257);const s=t=>null==t||void 0===t,o=async(t,e,n)=>(s(n)||(e?u(t,e,n):Object.assign(t,n)),t),l=async(t,e)=>{let n={};if(e)for(let r of e){const e=r.name,i=t.get(r);n=await o(n,e,i)}else for(let[{name:e},r]of t)n=await o(n,e,r);return n},c=/\./g,u=function(t,e,n){const r=e.split(c);if(2==arguments.length)return h(t,r);const i=s(n);return s(t)&&i?t:d(i,t,n,r)},d=(t,e,n,r)=>{if(s(e)&&t)return null;const i=r.shift();return 0==r.length?t?delete e[i]:e[i]=n:(s(e[i])&&(e[i]={}),d(t,e[i],n,r)),e},h=(t,e)=>{if(s(t))return null;if(0==e.length)return t;const n=e.shift();return h(t[n],e)};var p=n(494);const f=(t,e,n=!1)=>{const i=t.active;e?t.attr(r.ATTRIBUTE_ACTIVE,""):t.attr(r.ATTRIBUTE_ACTIVE,null),(i!=e||n)&&t.trigger(r.EVENT_ACTIVE_STATE_CHANGED)},E=(t,e,n=!1)=>{const i=t.readonly;e?t.attr(r.ATTRIBUTE_READONLY,""):t.attr(r.ATTRIBUTE_READONLY,null),(i!=e||n)&&t.trigger(r.EVENT_EDITABLE_STATE_CHANGED)},T=(0,p.privatePropertyAccessor)("form"),m=[r.ATTRIBUTE_ACTIVE,r.ATTRIBUTE_READONLY,r.ATTRIBUTE_CONDITION,r.ATTRIBUTE_CONDITION_VALID,r.ATTRIBUTE_CONDITION_INVALID,r.ATTRIBUTE_EDITABLE_CONDITION];class g extends i.default{static get observedAttributes(){return m}#I;#_;#w;#O;constructor(){super(),this.#O=new class{#R=new Set;constructor(t){t.on(r.EVENT_MESSAGE_INITIALIZED,(t=>{t.preventDefault(),t.stopPropagation();const e=t.target;this.#R.add(e)})),t.on(r.EVENT_MESSAGE_REMOVED,(t=>{t.preventDefault(),t.stopPropagation();const e=t.target;this.#R.delete(e)}))}async validate(t){for(let e of this.#R)e.update(t)}}(this),this.#I=new class{#D;#h;constructor(t){this.#D=t}get condition(){return this.#h||(this.#h=this.#D.attr(r.ATTRIBUTE_CONDITION)||!1),this.#h}async validate(t){const e=this.#D;let n=this.condition;const r=e.condition;return n=!n||await a.ExpressionResolver.resolve(n,t,!1),n!=r&&(e.condition=n),n}}(this),this.#_=new class{#D;#h=null;constructor(t){this.#D=t}get condition(){return null==this.#h&&(this.#h=this.#D.attr(r.ATTRIBUTE_EDITABLE_CONDITION)||""),this.#h}async validate(t){let e=!0;const n=this.#D.editable;return this.condition&&(e=await a.ExpressionResolver.resolve(this.condition,t,!1)),e!=n&&(this.#D.editable=e),e}}(this),this.#w=new class{#D;#b=new Set;#M=new Set;constructor(t){this.#D=t,t.on(r.EVENT_VALIDATION_INITIALIZED,(t=>{t.stopPropagation(),this.#b.add(t.target)})),t.on(r.EVENT_VALIDATION_REMOVED,(t=>{t.stopPropagation(),this.#b.delete(t.target)}))}addCustomValidation(t){this.#M.add(t)}async validate(t){const e=this.#D,n=this.#M,r=this.#b,{hasValue:i,required:s,condition:o,editable:l}=(this.#D.valid,this.#D);let c=!0;if(o){c=!s||i,await(async(t,e,n)=>{let r=!0;for(let i of t)await i({data:e,base:n})||(r=!1);return r})(n,t,e)||(c=!1);for(let e of r)if(c&&i){const n=await a.ExpressionResolver.resolve(e.condition,t,!0);e.active=!n,n||(c=!1)}else e.active=!1}return e.valid=c,c}}(this)}addValidation(t){this.#w.addCustomValidation(t)}async validate(t){this.attr(r.ATTRIBUTE_EVALUATE,"");const e=Object.assign({},t,await(async t=>{await t.ready;const e={};e[r.SPECIALVARS.CURRENTVALUE]=y(t);let n=t.parent(r.NODENAME_LIST_ROW),i=e;for(;n;)i[r.SPECIALVARS.CURRENTLISTROW]=await y(n),i=i[r.SPECIALVARS.CURRENTLISTROW],n=n.parent(r.NODENAME_LIST_ROW);return e})(this));return await this.#I.validate(e),await this.#_.validate(e),await this.#w.validate(e),this.attr(r.ATTRIBUTE_EVALUATE,null),await this.#O.validate(e),this.valid}get form(){let t=T(this);return t||(t=this.parent(r.NODENAME_FORM),T(this,t)),t}get active(){return this.hasAttribute(r.ATTRIBUTE_ACTIVE)}set active(t){this.active!=t&&(f(this,t),this.activeUpdated())}async activeUpdated(){}get readonly(){return this.hasAttribute(r.ATTRIBUTE_READONLY)}set readonly(t){this.editable?E(this,t,!this.ready.resolved):E(this,!0,!this.ready.resolved),this.readonlyUpdated()}async readonlyUpdated(){}get editable(){return this.hasAttribute(r.ATTRIBUTE_EDITABLE)}set editable(t){((t,e,n=!1)=>{const i=t.editable;e?t.attr(r.ATTRIBUTE_EDITABLE,""):t.attr(r.ATTRIBUTE_EDITABLE,null),(i!=e||n)&&t.trigger(r.EVENT_EDITABLE_STATE_CHANGED)})(this,t,!this.ready.resolved),this.editableUpdated(),this.readonly=!t}async editableUpdated(){}set condition(t){var e,n;e=this,void 0===(n=t)||null==n?(e.attr(r.ATTRIBUTE_CONDITION_INVALID,null),e.attr(r.ATTRIBUTE_CONDITION_VALID,null)):n?(e.attr(r.ATTRIBUTE_CONDITION_INVALID,null),e.attr(r.ATTRIBUTE_CONDITION_VALID,"")):(e.attr(r.ATTRIBUTE_CONDITION_VALID,null),e.attr(r.ATTRIBUTE_CONDITION_INVALID,"")),e.trigger(r.EVENT_CONDITION_STATE_CHANGED),this.conditionUpdated()}get condition(){return!this.hasAttribute(r.ATTRIBUTE_CONDITION_INVALID)}async conditionUpdated(){}set valid(t){((t,e)=>{void 0===e||null==e?(t.attr(r.ATTRIBUTE_INVALID,null),t.attr(r.ATTRIBUTE_VALID,null)):e?(t.attr(r.ATTRIBUTE_INVALID,null),t.attr(r.ATTRIBUTE_VALID,"")):(t.attr(r.ATTRIBUTE_INVALID,""),t.attr(r.ATTRIBUTE_VALID,null)),t.trigger(r.EVENT_VALID_STATE_CHANGED)})(this,t),this.validUpdated()}get valid(){return this.hasAttribute(r.ATTRIBUTE_VALID)}async validUpdated(){}}const A=g,v=t=>{if(s(t))return!0;const e=typeof t;return"string"===e&&0==t.trim().length||!(t instanceof Date)&&(t instanceof Array&&0==t.length||t instanceof Set&&0==t.length||t instanceof Map&&0==t.length||"object"==e&&0==Object.getOwnPropertyNames(t).length)},N=(0,p.privatePropertyAccessor)("parent"),y=(0,p.privatePropertyAccessor)("value"),I=[r.ATTRIBUTE_NAME,r.ATTRIBUTE_REQUIRED,r.ATTRIBUTE_NOVALUE];class _ extends A{static get observedAttributes(){return I.concat(A.observedAttributes)}constructor(t={}){super(t);const{value:e}=t;y(this,e||null)}async init(){this.ready.then((()=>this.trigger(r.EVENT_FIELD_INITIALIZED))),await super.init()}async destroy(){this.publishValue(null),await super.destroy(),this.trigger(r.EVENT_FIELD_REMOVED)}get parentField(){let t=N(this);return t||(t=(t=>{let e=this.parentNode;for(;e;){if(e instanceof _)return e;e=e.parentNode}return null})(),N(this,t)),t}async conditionUpdated(){return this.active=this.condition,this.publishValue()}get name(){return this.getAttribute(r.ATTRIBUTE_NAME)}get required(){return this.hasAttribute(r.ATTRIBUTE_REQUIRED)}get hasValue(){return!this.hasAttribute(r.ATTRIBUTE_NOVALUE)}async value(t){const{condition:e,valid:n,ready:r}=this;if(0==arguments.length)return e&&n?y(this):null;await r;const i=y(this);if(await this.acceptValue(t)&&i!=(t=await this.normalizeValue(t)||t)){const e=await this.updatedValue(t);void 0!==e&&(t=e),await this.publishValue(t)}}async validate(t){const e=this.condition,n=this.valid,r=await super.validate(t),i=this.condition;return this.validationStateChanged(e!=i,n!=r),r}async validationStateChanged(t,e){(t||e)&&this.publishValue()}async updatedValue(t){return t}async publishValue(t){await this.ready,0==arguments.length&&(t=y(this));const e=v(t),n=this.condition;var i;t=this.required&&e?null:t,n?y(this,t):t=null,i=!e,this.attr(r.ATTRIBUTE_NOVALUE,i?null:""),this.parentField?await this.parentField.childValueChanged(this,t):this.form&&await this.form.childValueChanged(this,t)}async acceptValue(t){return!0}async normalizeValue(t){return t}async childValueChanged(t,e){}}const w=_,O=(t,e,n,i)=>{let a=null;const s="function"==typeof e?e:()=>e,o="function"==typeof n?n:()=>n;return e=>{s(e)&&e.preventDefault(),o(e)&&e.stopPropagation();const n=(t=>({type:t.type,target:t.target,detail:t.detail,currentTarget:t.currentTarget,explicitOriginalTarget:t.explicitOriginalTarget,originalTarget:t.originalTarget,srcElement:t.srcElement,timeStamp:t.timeStamp}))(e);a&&clearTimeout(a),a=setTimeout((()=>{a=null,t(n)}),i||r.EVENTHANDLE_TIMEOUT)}};class R{static findInput(t){return null}#x;constructor(t,e){this.field=t,this.input=e,this.init()}init(){}set readonly(t){}async acceptValue(t){return!0}async normalizeValue(t){return t}async updatedValue(){}get value(){return null}get valid(){return!0}}const D="text",b=t=>({accept:t=>"number"==typeof t,getValue:()=>t.valueAsNumber,setValue:e=>{t.valueAsNumber=e},normalize:t=>s(t)||Number.isNaN(t)?null:t}),M=t=>({accept:t=>"string"==typeof t,getValue:()=>t.value,setValue:e=>{t.value=e},normalize:t=>t||null}),x=new Intl.DateTimeFormat("default",{hour:"numeric",minute:"numeric"}),V={text:t=>({accept:t=>"string"==typeof t,getValue:()=>t.value,setValue:e=>t.value=e,normalize:t=>t&&(t=t.trim()).length>0?t:null}),number:b,datetime:M,"datetime-locale":M,date:t=>({accept:t=>t instanceof Date,getValue:()=>t.valueAsDate,setValue:e=>{t.valueAsDate=e},normalize:t=>t||null}),time:t=>({accept:t=>t instanceof Date,getValue:()=>t.value?new Date(`1970-01-01T${t.value}`):null,setValue:e=>{t.value=x.format(e)},normalize:t=>t||null}),range:b},L=(0,p.privatePropertyAccessor)("value"),S=(t,e)=>new Promise(((n,r)=>{const i=new FileReader;i.addEventListener("loadend",(()=>{n({name:t.name,type:t.type,size:t.size,data:i.result})}),!1),i[e](t)})),U={"form-input":async t=>(t.format="form-input",t),"data-url-base64":async t=>{const e=await S(t,"readAsDataURL");return e.format="data-url-base64",e},base64:async t=>{const e=await S(t,"readAsDataURL");return e.data=e.data.substr(e.data.indexOf(",")+1),e.format="base64",e}},P=async(t,e,n)=>{let r=[];for(let n of t)r.push(await U[e](n));return 0==r.length?null:n?r:r[0]},C=[class extends R{static findInput(t){return t.find('input:not([type="file"],[type="radio"],[type="checkbox"],[type="button"],[type="submit"],[type="reset"]),input:not([type]), textarea').first()}constructor(t,e){super(t,e)}init(){const{field:t,input:e}=this,n=(t.attr("input-type")||e.attr("type")||D).trim().toLowerCase();this.type=(V[n]||V[D])(e),e.on("input",O((()=>{t.trigger(r.EVENT_FIELD_INPUT,this.normalizeValue(this.value))}),!1,!0,r.EVENTHANDLE_INPUT_TIMEOUT)),t.trigger(r.EVENT_FIELD_INPUT,this.normalizeValue(this.value))}acceptValue(t){return null==t||void 0===t||this.type.accept(t)}normalizeValue(t){return null==t&&void 0===t?null:this.type.normalize(t)}async updatedValue(t){t!=this.type.getValue()&&this.type.setValue(t)}set readonly(t){this.input.attr("disabled",t?"":null)}get value(){return this.type.getValue()}get valid(){return this.input.checkValidity()}},class extends R{static findInput(t){const e=t.find('input[type="checkbox"]');return 0==e.length?null:1==e.length?e.first():e}constructor(t,e){super(t,e)}init(){const{field:t,input:e}=this;this.multiple=e instanceof NodeList,e.on("input",O((()=>{t.trigger(r.EVENT_FIELD_INPUT,this.normalizeValue(this.value))}),!1,!0,r.EVENTHANDLE_INPUT_TIMEOUT)),t.trigger(r.EVENT_FIELD_INPUT,this.normalizeValue(this.value))}set readonly(t){this.input.attr("disabled",t?"":null)}get value(){const t=this.input.val();if(!(t instanceof Map))return t;if(0==t.size)return null;const e=[];return t.forEach((t=>{e.push(t)})),e}normalizeValue(t){return t?this.multiple?0!=(t=t.filter((t=>!!t))).length?t:null:t:null}acceptValue(t){if(null==t||void 0===t)return!0;if(this.multiple)return t instanceof Array;{const e=typeof t;return"string"===e||"boolean"===e}}updatedValue(t){this.input.val(t||null)}},class extends R{static findInput(t){const e=t.find('input[type="radio"]');return 0==e.length?null:e}constructor(t,e){super(t,e)}init(){const{field:t,input:e}=this,n=t.name+Math.floor(Math.random()*Date.now());for(let t of e)t.name=n;e.on("input",O((()=>{t.trigger(r.EVENT_FIELD_INPUT,this.normalizeValue(this.value))}),!1,!0,r.EVENTHANDLE_INPUT_TIMEOUT)),t.trigger(r.EVENT_FIELD_INPUT,this.normalizeValue(this.value))}set readonly(t){this.input.attr("disabled",t?"":null)}get value(){const t=this.input.val();return t instanceof Map?0==t.size?null:t.values().next().value:t}normalizeValue(t){return t||null}acceptValue(t){if(null==t||void 0===t)return!0;{const e=typeof t;return"string"===e||"boolean"===e}}updatedValue(t){this.input.val(t||null)}},class extends R{static findInput(t){return t.find('input[type="file"]').first()}constructor(t,e){super(t,e)}async init(){const{field:t,input:e}=this;this.multiple=e.multiple,this.format=t.attr("file-format")||"form-input",this.filenameTarget=t.attr("file-name-target"),this.filenameTarget=this.filenameTarget?t.find(this.filenameTarget).first():null;const{format:n,multiple:i}=this;e.on("input",O((async()=>{this.updatedValue(await P(e.files,n,i)),t.trigger(r.EVENT_FIELD_INPUT,this.value)}),!1,!0)),e.files&&0!=e.files.length&&this.updatedValue(await P(e.files,n,i)),t.trigger(r.EVENT_FIELD_INPUT,this.value)}set readonly(t){this.input.attr("disabled",t?"":null)}acceptValue(t){return null==t||void 0===t||(this.multiple?t instanceof Array:"object"==typeof t)}normalizeValue(t){return null==t||void 0===t?null:this.multiple?0!=t.length?t:null:t}updatedValue(t){if(t!=L(this)){L(this,t),t||(this.input.value=null);const e=this.filenameTarget;if(e&&(e.empty(),t))if(this.multiple)for(let n of t)e.append(`<span>${n.name}</span>`);else e.append(`<span>${t.name}</span>`)}}get value(){return L(this)}get valid(){return this.input.checkValidity()}},class extends R{static findInput(t){return t.find("select").first()}constructor(t,e){super(t,e)}init(){const{field:t,input:e}=this;e.on("input, changed",O((()=>{t.trigger(r.EVENT_FIELD_INPUT,this.value)}),!1,!0,r.EVENTHANDLE_INPUT_TIMEOUT))}set readonly(t){this.input.attr("disabled",t?"":null)}get value(){return this.normalizeValue(this.input.multiple?this.input.val():this.input.value)}normalizeValue(t){return t?this.input.multiple?0!=(t=t.filter((t=>t&&t.trim().length>0))).length?t:null:0!=(t=t.trim()).length?t:null:null}acceptValue(t){return null==t||void 0===t||(this.input.multiple?t instanceof Array:"string"==typeof t)}updatedValue(t){const e=this.input.val();this.field.value!=this.value&&this.input.val(t||e)}}];var B=n(303);const F=["file-format"];class H extends w{static get observedAttributes(){return F.concat(w.observedAttributes)}static get NODENAME(){return r.NODENAME_FIELD}#d=!1;#V;constructor(t){super(t),this.on(r.EVENT_FIELD_INPUT,(t=>{t.preventDefault(),t.stopPropagation(),this.publishValue(t.detail||null)}))}async init(){await super.init(),this.#d||(this.#d=!0,this.#V=(t=>{for(let e of C){const n=e.findInput(t);if(n)return new e(t,n)}return null})(this),this.#V&&(this.addValidation((async()=>this.#V.valid)),this.publishValue(this.#V.value)))}readonlyUpdated(){this.#V&&(this.#V.readonly=this.readonly)}async acceptValue(t){return!!this.#V&&this.#V.acceptValue(t)}async normalizeValue(t){return this.#V?this.#V.normalizeValue(t):t}async updatedValue(t){await this.ready,t=await t;const e=this.#V;e&&(e.value||null)!=t&&await e.updatedValue(t),await super.updatedValue(t)}async validationStateChanged(t,e){if(t&&this.condition){const t=this.#V.value||null;y(this,t)}return super.validationStateChanged(t,e)}}(0,B.define)(H);const j=H,$=[r.ATTRIBUTE_ACTIVE,r.ATTRIBUTE_CONDITION];class G extends B.Component{static get observedAttributes(){return $}static get NODENAME(){return r.NODENAME_VALIDATION}constructor(){super()}async init(){await super.init(),this.active=!1,this.ready.then((()=>this.trigger(r.EVENT_VALIDATION_INITIALIZED)))}async destroy(){this.trigger(r.EVENT_VALIDATION_REMOVED),await super.destroy()}get active(){return this.hasAttribute(r.ATTRIBUTE_ACTIVE)}set active(t){t?this.attr(r.ATTRIBUTE_ACTIVE,""):this.attr(r.ATTRIBUTE_ACTIVE,void 0)}get condition(){return this.attr(r.ATTRIBUTE_CONDITION)}}(0,B.define)(G);const z=({root:t,filter:e})=>{let n=[];return t.children.forEach((t=>{const{accept:r,stop:i=!1}=e(t);if(r&&n.push(t),!i){const r=z({root:t,filter:e});r instanceof Array?n=n.concat(r):r&&n.push(r)}})),n},k=async(t,e)=>(await Promise.all(e.map((e=>e.validate(t))))).reduce(((t,e)=>!!t&&e),!0),W=[];class Y extends w{static get observedAttributes(){return W.concat(w.observedAttributes)}static get NODENAME(){return r.NODENAME_CONTAINER}#L=null;#S=new Map;constructor(t){super(t);const e=this.root;e.on(r.EVENT_FIELD_INITIALIZED,(t=>{const e=t.target;e!=this&&(!(e instanceof w)||this.#L&&this.#L.has(e)||(this.#L=null),t.stopPropagation())})),e.on(r.EVENT_FIELD_REMOVED,(t=>{const e=t.target;e!=this&&(e instanceof w&&this.#L&&this.#L.has(e)&&this.#L.delete(e),t.stopPropagation())})),this.addValidation((async({data:t})=>await k(t,this.fields)))}get fields(){return this.#L||(this.#L=new Set(z({root:this,filter:t=>t instanceof w?{accept:!0,stop:!0}:{accept:!1}}))),Array.from(this.#L)}readonlyUpdated(){const{readonly:t,fields:e}=this;if(e)for(let n of e)n.readonly=t}async updatedValue(t){await this.ready;const e=this.#S;e.clear();const n=this.fields;n&&await Promise.all(n.map((async n=>{const r=n.name?u(t,n.name):t;s(r)||e.set(n,r),await n.value(r)})));let r=await l(this.#S,n);return 0==Object.getOwnPropertyNames(r).length&&(r=null),r}async childValueChanged(t,e){e=await e;const n=this.#S;if(t){const r=n.has(t),i=n.get(t);if(r&&i==e)return;s(e)?n.delete(t):n.set(t,e)}let r=await l(n,this.fields);0==Object.getOwnPropertyNames(r).length&&(r=null),await this.publishValue(r)}}(0,B.define)(Y);const Z=Y,q=[r.ATTRIBUTE_ACTIVE,r.ATTRIBUTE_DISABLED];class K extends B.Component{static get observedAttributes(){return q}#d=!1;#U;constructor(){super(),this.on("click",(t=>{t.preventDefault(),t.stopPropagation(),this.active&&!this.disabled&&this.execute()}))}async init(){await super.init(),this.#d&&(this.active=!1,this.disabled=!1,this.#d=!0)}get form(){return this.#U||(this.#U=this.parent(r.NODENAME_FORM)),this.#U}get active(){return this.hasAttribute(r.ATTRIBUTE_ACTIVE)}set active(t){this.attr(r.ATTRIBUTE_ACTIVE,t?"":null)}get disabled(){return this.hasAttribute(r.ATTRIBUTE_DISABLED)}set disabled(t){this.attr(r.ATTRIBUTE_DISABLED,t?"":null)}execute(){console.log("execute")}}const X=K,Q=[];(0,B.define)(class extends X{static get observedAttributes(){return Q.concat(Q)}static get NODENAME(){return r.NODENAME_LIST_DELETE_ROW}constructor(){super()}async init(){await super.init(),this.active=!0}execute(){this.trigger(r.EVENT_LIST_ROW_DELETE)}});const J=[];class tt extends Z{static get observedAttributes(){return J.concat(Z.observedAttributes)}static get NODENAME(){return r.NODENAME_LIST_ROW}constructor(t){super(t)}get active(){return!0}set active(t){}get condition(){return!0}get name(){return null}}customElements.define(tt.NODENAME,tt);const et=`${r.NODENAME_LIST_ADD_ROW}:initialized`,nt=[];(0,B.define)(class extends X{static get observedAttributes(){return nt.concat(nt)}static get NODENAME(){return r.NODENAME_LIST_ADD_ROW}constructor(){super(),this.ready.then((()=>this.trigger(et)))}async init(){await super.init(),this.active=!0}execute(){this.trigger(r.EVENT_LIST_ROW_ADD)}});const rt=[];class it extends B.Component{static get observedAttributes(){return rt}static get NODENAME(){return r.NODENAME_LIST_ROWS}constructor(){super()}}(0,B.define)(it);const at=[r.ATTRIBUTE_MIN,r.ATTRIBUTE_MAX],st=async(t,e)=>{let n=[];for(let r of t)n.push(e.get(r));return 0==n.length&&(n=null),n};class ot extends w{static get observedAttributes(){return at.concat(w.observedAttributes)}static get NODENAME(){return r.NODENAME_LIST}#a;#P;#g=new Map;#C;#d=!1;constructor(t){super(t);const e=this.root;e.on(et,(t=>{this.#C=t.target,t.stopPropagation()})),e.on(r.EVENT_FIELD_INITIALIZED,(t=>{t.target!=this&&(t.preventDefault(),t.stopPropagation())})),e.on(r.EVENT_LIST_ROW_ADD,(t=>{t.preventDefault(),t.stopPropagation();const{readonly:e}=this;e||this.createRow()})),e.on(r.EVENT_LIST_ROW_DELETE,(t=>{t.preventDefault(),t.stopPropagation();const{rows:e,readonly:n}=this;if(!n){const n=t.target.parent(r.NODENAME_LIST_ROW);e.indexOf(n)>=0&&n.remove()}})),this.addValidation((async()=>{const{rows:t,min:e,max:n,readonly:r}=this,i=t.length;return this.#C&&!r&&(i==n?this.#C.disabled=!0:i<n&&(this.#C.disabled=!1)),e<=i&&i<=n})),this.addValidation((async t=>await k(t,this.rows)))}async init(){if(await super.init(),!this.#d){this.#d=!0;const t=this.find("template").first();t&&(this.#a=t.content),this.#P=this.find(r.NODENAME_LIST_ROWS).first()}}readonlyUpdated(){const{readonly:t}=this;for(let e of this.rows)e.readonly=t}get rows(){return this.#P?Array.from(this.#P.children):[]}get min(){return this.hasAttribute(r.ATTRIBUTE_MIN)?Math.max(0,parseInt(this.attr(r.ATTRIBUTE_MIN))):0}get max(){return this.hasAttribute(r.ATTRIBUTE_MAX)?parseInt(this.attr(r.ATTRIBUTE_MAX)):Number.MAX_SAFE_INTEGER}acceptValue(t){return!t||t instanceof Array}normalizeValue(t){return t?t.filter((t=>!!t)):null}async createRow(t){const e=document.importNode(this.#a,!0).children[0];return await this.#P.append(e),t&&await e.value(t),e}async updatedValue(t){return this.#g.clear(),this.#P.empty(),t&&await Promise.all(t.map((t=>this.createRow(t)))),await st(this.rows,this.#g)}async childValueChanged(t,e){e=await e;const n=this.#g;s(e)?this.#g.delete(t):this.#g.set(t,e),await super.childValueChanged(t,e);const r=await st(this.rows,n);await this.publishValue(r)}}(0,B.define)(ot);const lt=ot,ct=[r.ATTRIBUTE_STEP];class ut extends Z{static get observedAttributes(){return ct.concat(Z.observedAttributes)}static get NODENAME(){return r.NODENAME_PAGE}constructor(t){super(t),this.ready.then((()=>this.trigger(r.EVENT_PAGE_INITIALIZED)))}async destroy(){this.trigger(r.EVENT_PAGE_REMOVED),await super.destroy()}get step(){return this.attr(r.ATTRIBUTE_STEP)}conditionUpdated(){}}(0,B.define)(ut);const dt=ut,ht="active",pt="condition",ft=[ht,pt];class Et extends B.Component{static get observedAttributes(){return ft}static get NODENAME(){return r.NODENAME_MESSAGE}constructor(){super()}async init(){await super.init(),this.trigger(r.EVENT_MESSAGE_INITIALIZED)}async destroy(){this.trigger(r.EVENT_MESSAGE_REMOVED),await super.destroy()}get active(){return this.hasAttribute(ht)}set active(t){t?this.attr(ht,""):this.attr(ht,void 0)}get condition(){return this.attr(pt)}async update(t){await this.ready,this.active=await a.ExpressionResolver.resolve(this.condition,t,!1)}}(0,B.define)(Et);const Tt=[];(0,B.define)(class extends X{static get observedAttributes(){return Tt}static get NODENAME(){return r.NODENAME_CONTROL_BACK}constructor(){super()}execute(){this.form.toPrevPage()}});const mt=[];(0,B.define)(class extends X{static get observedAttributes(){return mt}static get NODENAME(){return r.NODENAME_CONTROL_NEXT}constructor(){super()}execute(){this.form.toNextPage()}});const gt=[];(0,B.define)(class extends X{static get observedAttributes(){return gt}static get NODENAME(){return r.NODENAME_CONTROL_SUMMARY}constructor(){super()}execute(){this.form.toNextPage()}});const At=[];(0,B.define)(class extends X{static get observedAttributes(){return At}static get NODENAME(){return r.NODENAME_CONTROL_SUBMIT}constructor(){super()}execute(){this.form.submit()}});const vt={active:!0,disabled:!0},Nt=[];class yt extends B.Component{static get observedAttributes(){return Nt}static get NODENAME(){return r.NODENAME_CONTROL}#U;#B;#F;#H;#j;#d=!1;constructor(){super()}async init(){await super.init(),this.#d||(this.#U=this.parent(r.NODENAME_FORM),this.#B=this.find(r.NODENAME_CONTROL_BACK).first()||vt,this.#F=this.find(r.NODENAME_CONTROL_NEXT).first()||vt,this.#H=this.find(r.NODENAME_CONTROL_SUMMARY).first()||vt,this.#j=this.find(r.NODENAME_CONTROL_SUBMIT).first()||vt,this.#U.on([r.EVENT_INITIALIZED,r.EVENT_FORM_STATE_CHANGED,r.EVENT_SITE_CHANGED],(()=>{this.update()})),this.#d=!0)}async update(){const t=this.#U,e=t.state,n=this.#B,i=this.#F,a=this.#H,s=this.#j;if(n.active=!0,n.disabled=!0,i.active=!1,i.disabled=!0,a.active=!1,a.disabled=!0,s.active=!1,s.disabled=!0,e==r.FORMSTATE_VALIDATING)return;const{activePageIndex:o,activePage:l,nextPage:c,pages:u,useSummaryPage:d}=t,h=null!=await c;e==r.FORMSTATE_FINISHED?(n.disabled=!0,s.active=!0):e==r.FORMSTATE_SUMMARY?(n.disabled=!1,s.active=!0,s.disabled=!t.valid):e==r.FORMSTATE_INPUT&&(n.disabled=o<=0,h||!l.valid&&o+1<u.length?(i.active=!0,i.disabled=!l.valid):d&&e==r.FORMSTATE_INPUT?(a.active=!0,a.disabled=!l.valid):(s.active=!0,s.disabled=!t.valid))}}(0,B.define)(yt);const It=[r.ATTRIBUTE_NAME,r.ATTRIBUTE_ACTIVE,r.ATTRIBUTE_READONLY];class _t extends B.Component{static get observedAttributes(){return It}static get NODENAME(){return r.NODENAME_STEP}constructor(){super()}get name(){return this.attr(r.ATTRIBUTE_NAME)}get active(){return this.hasAttribute(r.ATTRIBUTE_ACTIVE)}set active(t){this.active!=t&&f(this,t)}get readonly(){return this.hasAttribute(r.ATTRIBUTE_READONLY)}set readonly(t){t?this.attr(r.ATTRIBUTE_READONLY,""):this.attr(r.ATTRIBUTE_READONLY,null)}}(0,B.define)(_t);const wt=[r.ATTRIBUTE_PROGRESS];class Ot extends B.Component{static get observedAttributes(){return wt}static get NODENAME(){return r.NODENAME_PROGESSBAR}#U;#$;#d=!1;constructor(){super(),this.on("click",(({target:t})=>{if(!this.#U)return;if(t==this)return;const e=t.is(r.NODENAME_STEP)?t:t.parent(r.NODENAME_STEP),n=this.#U;if(!e)return;const{state:i,pages:a,activePage:s}=n,o=e.name;if(i==r.FORMSTATE_INPUT||i==r.FORMSTATE_SUMMARY){const t=((t,e,n)=>{for(let r of t){if(r.step==e&&r.condition)return r;if(r==n)return}return null})(a,o,s);t&&(n.activePage=t)}}))}async init(){if(await super.init(),this.progress=0,!this.#d){const t=this.#U=this.parent(r.NODENAME_FORM);this.#$=this.find(r.NODENAME_STEP),this.#U.on([r.EVENT_SITE_CHANGED,r.EVENT_FORM_STATE_CHANGED],(()=>{const e=t.state;if(r.FORMSTATE_VALIDATING==e)return;const{activePageIndex:n,activePage:i,pages:a}=t;if(!i)return;const s=a.length,o=i?i.step:r.FORMSTATE_INIT,l=Math.floor(100*n/s);for(let t of this.steps){const n=t.name;e==r.FORMSTATE_INPUT?(t.active=n==o,t.readonly=!1):e==r.FORMSTATE_SUMMARY?(t.active=n==r.FORMSTATE_SUMMARY,t.readonly=!1):(t.active=n==r.FORMSTATE_FINISHED,t.readonly=!0)}this.progress=e==r.FORMSTATE_SUMMARY||e==r.FORMSTATE_FINISHED?100:l,this.trigger(r.EVENT_PROGRESSBAR_CHANGED)})),this.#d=!0}}get steps(){return Array.from(this.#$)}get progress(){return this.attr(r.ATTRIBUTE_PROGRESS)}set progress(t){this.style.setProperty&&this.style.setProperty("--progress",t+"%"),this.attr(r.ATTRIBUTE_PROGRESS,Math.max(0,Math.min(t,100)))}}(0,B.define)(Ot);const Rt="success",Dt="fail",bt=class{static get STATE_SUCCESS(){return Rt}static get STATE_FAIL(){return Dt}constructor(t,e,n,r){this.action=t,this.state=e,this.message=n,this.data=r}},Mt=(0,p.privatePropertyAccessor)("form");class xt extends i.default{constructor(){super()}async init(){await super.init();const t=this.parent(r.NODENAME_FORM);Mt(this,t),t&&this.trigger(r.EVENT_INITIALIZE_SUBMIT_ACTION)}get form(){return Mt(this)}async accept(t={}){const e=this.attr(r.ATTRIBUTE_CONDITION);return!e||await a.ExpressionResolver.resolve(e,t,!1)}async execute(t={}){return new bt(Dt,"not implemented")}}const Vt=xt,Lt=`${r.NODENAME_SUBMIT_ACTION}-default`;class St extends Vt{static get NODENAME(){return Lt}constructor(t,e){super(),this.endpoint=t,this.method=e}async execute(t){let e=this.endpoint;e=await a.ExpressionResolver.resolveText(e,t,e);const n=new URL(e,location),r=await fetch(n,{method:this.method,credentials:"include",mode:"cors",headers:{"content-type":"application/json"},body:JSON.stringify(t)});return new bt(this,r.ok?Rt:Dt,r)}}(0,B.define)(St);const Ut=St,Pt=(0,p.privatePropertyAccessor)("submitAction"),Ct=[r.ATTRIBUTE_NAME,r.ATTRIBUTE_USE_SUMMARY_PAGE,r.ATTRIBUTE_ENDPOINT,r.ATTRIBUTE_METHOD,r.ATTRIBUTE_STATE,r.ATTRIBUTE_INPUT_MODE_AFTER_SUBMIT],Bt=(t,e)=>{for(let n of t.pages)n.readonly=e,n.active=e};class Ft extends B.Component{static get observedAttributes(){return Ct}static get NODENAME(){return r.NODENAME_FORM}#d=!1;#G=r.FORMSTATE_INIT;#z;#S=new Map;#k={};#W=null;#Y=!1;constructor(){super();const t=this.root;t.on(r.EVENT_PAGE_INITIALIZED,(t=>{t.preventDefault(),t.stopPropagation()})),t.on(r.EVENT_PAGE_REMOVED,(t=>{const e=t.target;this.#z=null,this.childValueChanged(e,null),t.preventDefault(),t.stopPropagation()})),this.ready.then((()=>this.trigger(r.EVENT_INITIALIZED)))}async init(){await super.init(),this.#d||(this.#d=!0,this.activePageIndex=-1,this.state=r.FORMSTATE_INIT,this.useSummaryPage=this.hasAttribute(r.ATTRIBUTE_USE_SUMMARY_PAGE),this.activePageIndex=-1,this.pages.length>0&&this.toNextPage())}get pages(){return this.#z||(this.#z=Array.from(this.root.find(r.NODENAME_PAGE))),this.#z}get state(){return this.#G}set state(t){const e=this.#G;t!=r.FORMSTATE_VALIDATING&&(e==r.FORMSTATE_INPUT&&t!=r.FORMSTATE_INPUT?Bt(this,!0):e!=r.FORMSTATE_INPUT&&t==r.FORMSTATE_INPUT&&(Bt(this,!1),this.activePage&&(this.activePage.active=!0))),this.#G=t,e!=t&&this.trigger(r.EVENT_FORM_STATE_CHANGED),this.attr(r.ATTRIBUTE_STATE,t)}get valid(){for(let t of this.pages)if(t.condition&&!t.valid)return!1;return!0}async value(t){return await this.ready,this.#W&&await this.#W,0==arguments.length?this.#k:this.state!=r.FORMSTATE_INPUT?new Promise((e=>{const n=i=>{i.stopPropagation(),this.removeOn(n,r.EVENT_FORM_STATE_CHANGED),e(this.value(t))};this.on(r.EVENT_FORM_STATE_CHANGED,n)})):(await Promise.all(this.pages.map((e=>{const n=e.name;return n?e.value(u(t,n)):e.value(t)}))),void await this.#Z())}get activePage(){return 0<=this.activePageIndex&&this.activePageIndex<this.pages.length?this.pages[this.activePageIndex]:null}set activePage(t){const e=this.activePage;t==e&&this.state==r.FORMSTATE_INPUT||(e&&(e.active=!1),this.activePageIndex=this.pages.indexOf(t),t.active=!0,this.state!=r.FORMSTATE_INPUT&&(this.state=r.FORMSTATE_INPUT),this.scrollIntoView(),this.trigger(r.EVENT_SITE_CHANGED))}get prevPage(){return(async()=>{const t=this.pages,e=this.activePageIndex-1,n=await this.value();for(let r=e;r>=0;r--){const e=t[r];if(await e.validate(n),e.condition)return e}return null})()}get nextPage(){return(async()=>{const t=this.pages,e=this.activePageIndex+1,n=await this.value();if(t)for(let r=e;r<t.length;r++){const e=t[r];if(await e.validate(n),e.condition)return e}return null})()}async toPrevPage(){if(this.state!=r.FORMSTATE_INPUT)this.state=r.FORMSTATE_INPUT;else{const t=await this.prevPage;t&&(this.activePage=t)}}async toNextPage(){const t=await this.nextPage;t?(this.activePage=t,this.state=r.FORMSTATE_INPUT):this.useSummaryPage?this.summary():this.submit()}async summary(){this.state=r.FORMSTATE_SUMMARY}get submitActions(){let t=Pt(this);if(!t){t=[];let e=this.attr(r.ATTRIBUTE_ENDPOINT);if(e){const t=this.attr(r.ATTRIBUTE_METHOD)||"post";this.append(new Ut(e,t))}const n=this.children;for(let e of n)e instanceof Vt&&t.push(e);Pt(this,t)}return t}async submit(){const t=await this.value();if(!await k(t,this.pages))return;this.hasAttribute(r.ATTRIBUTE_INPUT_MODE_AFTER_SUBMIT)||(this.state=r.FORMSTATE_FINISHED);const e=this.submitActions;if(e){const n=await(async(t,e)=>{const n=[];for(let r of t)if(await r.accept(e))try{const t=await r.execute(e)||new bt(r,Rt);if(n.push(t),t.state==Dt)return n}catch(t){return n.push(new bt(r,Dt,t)),n}return n})(e,t);this.trigger(r.EVENT_SUBMIT_RESULTS,n)}this.trigger(r.EVENT_SUBMIT,t)}#Z(t){if(this.state==r.FORMSTATE_INPUT)return this.state=r.FORMSTATE_VALIDATING,this.#W=new Promise((e=>{setTimeout((async()=>{const n=this.#k,i=t?t.validate(n):await k(n,this.pages);this.#Y||(this.state=r.FORMSTATE_INPUT),this.validation=null,e(i)}),10)}));this.state==r.FORMSTATE_VALIDATING&&this.#W.then((async()=>{this.#Y=!1,await this.#Z(t)}))}async childValueChanged(t,e){await this.ready,e=await e;const n=this.#S;t&&(s(e)?n.delete(t):n.set(t,e)),this.#k=await l(this.#S,this.pages);const r=this.activePage;r?await this.#Z(r):await this.#Z()}}(0,B.define)(Ft);const Ht=Ft},330:(t,e,n)=>{"use strict";n.r(e),n.d(e,{ATTRIBUTE_ACTIVE:()=>gt,ATTRIBUTE_CONDITION:()=>mt,ATTRIBUTE_CONDITION_INVALID:()=>Dt,ATTRIBUTE_CONDITION_VALID:()=>Rt,ATTRIBUTE_DISABLED:()=>At,ATTRIBUTE_EDITABLE:()=>vt,ATTRIBUTE_EDITABLE_CONDITION:()=>Nt,ATTRIBUTE_ENDPOINT:()=>ct,ATTRIBUTE_EVALUATE:()=>Ot,ATTRIBUTE_INPUT_MODE_AFTER_SUBMIT:()=>ft,ATTRIBUTE_INVALID:()=>wt,ATTRIBUTE_MAX:()=>Mt,ATTRIBUTE_METHOD:()=>ut,ATTRIBUTE_MIN:()=>bt,ATTRIBUTE_NAME:()=>lt,ATTRIBUTE_NOVALUE:()=>It,ATTRIBUTE_PROGRESS:()=>xt,ATTRIBUTE_READONLY:()=>yt,ATTRIBUTE_REQUIRED:()=>Et,ATTRIBUTE_REQUIRED_ON_ACTIVE_ONLY:()=>Tt,ATTRIBUTE_STATE:()=>dt,ATTRIBUTE_STEP:()=>ht,ATTRIBUTE_USE_SUMMARY_PAGE:()=>pt,ATTRIBUTE_VALID:()=>_t,EVENTHANDLE_INPUT_TIMEOUT:()=>s,EVENTHANDLE_TIMEOUT:()=>a,EVENT_ACTIVE_STATE_CHANGED:()=>it,EVENT_ALL_PUBLISH_VALUE:()=>$,EVENT_CONDITION_STATE_CHANGED:()=>j,EVENT_EDITABLE_STATE_CHANGED:()=>st,EVENT_EXECUTE_VALIDATE:()=>H,EVENT_FIELD_INITIALIZED:()=>K,EVENT_FIELD_INPUT:()=>W,EVENT_FIELD_REMOVED:()=>X,EVENT_FORM_STATE_CHANGED:()=>k,EVENT_INITIALIZE:()=>U,EVENT_INITIALIZED:()=>P,EVENT_INITIALIZE_SUBMIT_ACTION:()=>C,EVENT_LIST_ROW_ADD:()=>Y,EVENT_LIST_ROW_DELETE:()=>Z,EVENT_MESSAGE_INITIALIZED:()=>nt,EVENT_MESSAGE_REMOVED:()=>rt,EVENT_PAGE_INITIALIZED:()=>Q,EVENT_PAGE_REMOVED:()=>J,EVENT_PREFIX:()=>S,EVENT_PROGRESSBAR_CHANGED:()=>q,EVENT_SITE_CHANGED:()=>z,EVENT_SUBMIT:()=>B,EVENT_SUBMIT_RESULTS:()=>F,EVENT_VALIDATION_INITIALIZED:()=>tt,EVENT_VALIDATION_REMOVED:()=>et,EVENT_VALID_STATE_CHANGED:()=>at,EVENT_VALUE_CHANGED:()=>G,FORMSTATES:()=>V,FORMSTATE_FINISHED:()=>x,FORMSTATE_INIT:()=>R,FORMSTATE_INPUT:()=>b,FORMSTATE_SUMMARY:()=>M,FORMSTATE_VALIDATING:()=>D,HTML_TAG_PREFIX:()=>r,NODENAME_CONTAINER:()=>d,NODENAME_CONTROL:()=>N,NODENAME_CONTROL_BACK:()=>y,NODENAME_CONTROL_CANCEL:()=>_,NODENAME_CONTROL_NEXT:()=>I,NODENAME_CONTROL_SUBMIT:()=>O,NODENAME_CONTROL_SUMMARY:()=>w,NODENAME_FIELD:()=>u,NODENAME_FORM:()=>o,NODENAME_LIST:()=>h,NODENAME_LIST_ADD_ROW:()=>E,NODENAME_LIST_DELETE_ROW:()=>T,NODENAME_LIST_ROW:()=>f,NODENAME_LIST_ROWS:()=>p,NODENAME_MESSAGE:()=>v,NODENAME_PAGE:()=>c,NODENAME_PROGESSBAR:()=>m,NODENAME_STEP:()=>g,NODENAME_SUBMIT_ACTION:()=>l,NODENAME_VALIDATION:()=>A,REQUIREDSTATES:()=>L,SPECIALVARS:()=>ot,TRIGGER_TIMEOUT:()=>i});const r="d-",i=10,a=10,s=50*a,o=`${r}form`,l=`${r}submit-action`,c=`${r}page`,u=`${r}field`,d=`${r}container`,h=`${r}list`,p=`${r}rows`,f=`${r}row`,E=`${r}add-row`,T=`${r}delete-row`,m=`${r}progress-bar`,g=`${r}step`,A=`${r}validation`,v=`${r}message`,N=`${r}control`,y=`${r}control-back`,I=`${r}control-next`,_=`${r}control-cancel`,w=`${r}control-summary`,O=`${r}control-submit`,R="init",D="validating",b="input",M="summary",x="finished",V={init:R,validating:D,input:b,summary:M,finished:x},L={always:"always",onActive:"on-active"},S=r+"form-",U=`${S}initialize`,P=`${S}initialized`,C=`${U}submit-action`,B=`${S}submit`,F=`${S}submit-results`,H=`${S}execute-validate`,j=`${S}condition-state-changed`,$=`${S}all-publish-value`,G=`${S}field-value-changed`,z=`${S}site-changed`,k=`${S}state-changed`,W=`${S}field-input`,Y=`${S}list-row-add`,Z=`${S}list-row-delete`,q=`${S}progress-bar-changed`,K=`${S}field-initialized`,X=`${S}field-removed`,Q=`${S}page-initialized`,J=`${S}page-removed`,tt=`${S}validation-initialized`,et=`${S}validation-removed`,nt=`${S}message-initialized`,rt=`${S}message-removed`,it=`${S}active-state-changed`,at=`${S}valid-state-changed`,st=`${S}editable-state-changed`,ot={CURRENTVALUE:"$value",CURRENTLISTROW:"$item"},lt="name",ct="endpoint",ut="method",dt="state",ht="step",pt="use-summary-page",ft="input-mode-after-submit",Et="required",Tt="required-on-active-only",mt="condition",gt="active",At="disabled",vt="editable",Nt="editable-condition",yt="readonly",It="no-value",_t="valid",wt="invalid",Ot="evaluate",Rt="condition-valid",Dt="condition-invalid",bt="min",Mt="max",xt="progress"}},e={};function n(r){var i=e[r];if(void 0!==i)return i.exports;var a=e[r]={exports:{}};return t[r](a,a.exports,n),a.exports}n.d=(t,e)=>{for(var r in e)n.o(e,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var r={};(()=>{"use strict";n.r(r);var t=n(302),e=(n(979),n(892));t.default.defaultjs=t.default.defaultjs||{},t.default.defaultjs.html=t.default.defaultjs.html||{},t.default.defaultjs.html.form=t.default.defaultjs.html.form||{VERSION:"1.0.0",Form:e.Form,Page:e.Page,BaseField:e.BaseField,Field:e.Field,Container:e.Container,List:e.List,BaseSubmitAction:e.BaseSubmitAction,SubmitActionResult:e.SubmitActionResult};var i=n(97);t.default.defaultjs=t.default.defaultjs||{},t.default.defaultjs.html=t.default.defaultjs.html||{},t.default.defaultjs.html.form=t.default.defaultjs.html.form||{},t.default.defaultjs.html.form.fields=t.default.defaultjs.html.forms.fields||{},t.default.defaultjs.html.form.fields.FormTagFieldElement=t.default.defaultjs.html.form.fields.FormTagFieldElement||i.FormTagFieldElement})()})();
//# sourceMappingURL=browser-defaultjs-html-form-tag-field.min.js.map